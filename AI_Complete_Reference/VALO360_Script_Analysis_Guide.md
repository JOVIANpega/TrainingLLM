# VALO360 腳本分析指南 - AI 整合參考

## 📋 文件概述
**文件名稱**: VALO360_Script_Analysis_Guide.md  
**版本**: 1.0  
**創建日期**: 2025-01-XX  
**最後更新**: 2025-01-XX  
**文件類型**: VALO360 腳本分析 AI 參考文檔  
**適用對象**: AI 系統、開發者、測試工程師  

---

## 🎯 腳本概述

### 腳本基本信息
- **文件名稱**: VALO360_TestFlow_20250318_MB_ER2.xlsx
- **腳本類型**: VALO360 主機板測試流程腳本
- **測試對象**: 主機板 (MB) + 溫度測試 (TEMP)
- **版本信息**: 2025年3月18日版本
- **文件大小**: 74KB
- **工作表數量**: 6個

### 腳本用途
本腳本是一個完整的 VALO360 主機板測試系統，涵蓋了從設備配置到測試執行的全流程，每個欄位都有明確的功能定位，形成了結構化的測試自動化腳本。

---

## 📊 工作表結構分析

### 1. **Properties 工作表** - 腳本屬性配置
**尺寸**: 3 行 x 2 列  
**作用**: 定義腳本的基本屬性，包括版本號、創建者、失敗計數等配置信息

| 欄位名稱 | 功能說明 | 樣本值 | 數據類型 |
|----------|----------|--------|----------|
| **Name** | 屬性名稱定義 | Version, Creator, FailCount | 文本 |
| **Value** | 對應的屬性值 | 2503180956181, jovian_li, 0 | 混合 |

**欄位功能詳解**:
- **Version**: 腳本版本號，用於版本控制和追蹤
- **Creator**: 腳本創建者，便於責任追蹤和維護
- **FailCount**: 失敗計數器，用於統計測試失敗次數

### 2. **DUTs 工作表** - 被測設備配置
**尺寸**: 2 行 x 16 列  
**作用**: 定義被測設備的連接方式、通訊參數和識別信息

| 欄位名稱 | 功能說明 | 樣本值 | 數據類型 |
|----------|----------|--------|----------|
| **Load** | 負載變數名稱 | *$(LOAD_1) | 變數引用 |
| **DUT Name** | 被測設備名稱 | VALO360$MB, VALO360$TEMP | 設備標識 |
| **Station** | 測試站別 | MB,0, TEMP,0 | 站別配置 |
| **Parameter** | 連接參數 | *$(PCIP_1),*$(DUTIP_1) | 網路配置 |
| **SFIS_DeviceID** | SFIS 設備 ID | *$(DEVID_1) | 系統識別 |
| **ScanBarcode** | 條碼掃描設定 | {ISN,13,[0-9A-F]}; | 掃描規則 |
| **Connection1-10** | 連接配置 | APP,SSH,UART 等 | 通訊設定 |

**欄位功能詳解**:
- **Load**: 定義測試負載的變數引用，支援動態配置
- **DUT Name**: 唯一標識被測設備，區分不同測試對象
- **Station**: 定義測試站別和序號，支援多站測試
- **Parameter**: 網路連接參數，包括 IP 地址等配置
- **SFIS_DeviceID**: 工廠資訊系統的設備識別碼
- **ScanBarcode**: 條碼掃描的格式和規則定義
- **Connection1-10**: 多種通訊方式的配置，支援 APP、SSH、UART 等

### 3. **Switch 工作表** - 開關設備配置
**尺寸**: 1 行 x 7 列  
**作用**: 配置射頻開關等切換設備的控制參數和驅動程序

| 欄位名稱 | 功能說明 | 樣本值 | 數據類型 |
|----------|----------|--------|----------|
| **Name** | 開關設備名稱 | RFSwitch3001 | 設備標識 |
| **ControlDLL** | 控制 DLL 文件 | RFSwitch3001.dll | 驅動文件 |
| **Settings** | 設備設定參數 | GPIB,GPIB0::1::INSTR,1,1 | 硬體配置 |
| **Version** | 設備版本 | 1.0.0.0 | 版本信息 |
| **Loss** | 損耗值 | 0 | 數值參數 |
| **Desc** | 設備描述 | RF Switch 1 to 4 | 功能說明 |

**欄位功能詳解**:
- **Name**: 射頻開關的設備名稱，用於系統識別
- **ControlDLL**: 控制設備的動態連結庫文件
- **Settings**: GPIB 等硬體介面的配置參數
- **Version**: 設備驅動程序的版本號
- **Loss**: 射頻信號的損耗補償值
- **Desc**: 設備功能的詳細描述

### 4. **Instrument 工作表** - 測試儀器配置
**尺寸**: 40 行 x 9 列  
**作用**: 定義所有測試儀器的類型、連接參數、控制方式和功能

| 欄位名稱 | 功能說明 | 樣本值 | 數據類型 |
|----------|----------|--------|----------|
| **Mount** | 掛載位置 | MB | 位置標識 |
| **Name** | 儀器名稱 | IPOWER2401, OSP120, FeasaLED | 儀器標識 |
| **ControlDLL** | 控制 DLL 文件 | iPower2401.dll, NFT.dll | 驅動文件 |
| **Settings** | 儀器設定參數 | IP地址,端口,配置值 | 網路配置 |
| **Functions** | 儀器功能 | POWERSWITCH, NFT, LED_Test | 功能定義 |
| **Version** | 儀器版本 | 1.0.0.0, 2.1.0.1 | 版本信息 |
| **Switch** | 關聯開關 | RFSwitch3001 | 開關關聯 |
| **Desc** | 儀器描述 | Power Switch 2401, LED analyser | 功能說明 |

**欄位功能詳解**:
- **Mount**: 儀器在測試系統中的掛載位置
- **Name**: 儀器的唯一標識名稱
- **ControlDLL**: 控制儀器的驅動程序文件
- **Settings**: 儀器的網路或硬體配置參數
- **Functions**: 儀器支援的測試功能類型
- **Version**: 儀器驅動程序的版本號
- **Switch**: 與儀器關聯的開關設備
- **Desc**: 儀器功能的詳細描述

### 5. **MB 工作表** - 主機板測試流程 (核心工作表)
**尺寸**: 159 行 x 16 列  
**作用**: 定義主機板測試的完整流程，包括每個測試步驟的指令、參數、驗證條件和執行邏輯

| 欄位名稱 | 功能說明 | 樣本值 | 數據類型 |
|----------|----------|--------|----------|
| **Index_149** | 測試步驟索引 | 0, 1, 2, 3... | 序號 |
| **Phase** | 測試階段 | 0.0, 1.0, 2.0 | 階段標識 |
| **Title** | 測試階段標題 | CheckRoute, READ ME, Login | 階段名稱 |
| **Marco** | 巨集指令 | (未使用) | 巨集功能 |
| **Instrument** | 使用的儀器 | Voltage | 儀器引用 |
| **Switch** | 使用的開關 | NI6008-1 | 開關引用 |
| **Send** | 發送指令 | :ShowISN,"*(ISN)", :Disconnect,"UART" | 測試指令 |
| **Reply** | 預期回應 | 0 (成功) | 回應值 |
| **EndPrompt** | 結束提示符 | @root | 提示符 |
| **Ref** | 參考值/變數 | $DUT_SKU, $sfisSKU | 變數引用 |
| **Validation** | 驗證條件 | (DUT_SKU,%s,*$(sfisSKU),) | 驗證邏輯 |
| **Prompt** | 提示信息 | (未使用) | 提示文本 |
| **Waiting** | 等待時間 (毫秒) | 2000, 5000 | 時間參數 |
| **ExecMode** | 執行模式 | 1 (正常), 8 (特殊) | 執行控制 |
| **Description** | 測試描述 | PC#-#Show ISN to UI | 功能說明 |
| **TestID** | 測試項目 ID | B7PL025, OTFX064 | 測試標識 |

**欄位功能詳解**:
- **Index_149**: 測試步驟的順序編號，確保執行順序
- **Phase**: 測試階段的分類，支援多階段測試流程
- **Title**: 測試階段的描述性名稱，便於理解和管理
- **Marco**: 巨集指令功能，支援複雜的測試邏輯
- **Instrument**: 執行測試所需的儀器設備
- **Switch**: 控制測試信號的開關設備
- **Send**: 發送給被測設備的具體測試指令
- **Reply**: 預期的設備回應值，用於結果驗證
- **EndPrompt**: 測試結束後的提示符號
- **Ref**: 測試過程中的參考變數或值
- **Validation**: 測試結果的驗證條件和邏輯
- **Prompt**: 測試過程中的提示信息
- **Waiting**: 等待設備回應的時間設定
- **ExecMode**: 測試步驟的執行模式控制
- **Description**: 測試步驟的詳細功能描述
- **TestID**: 測試項目的唯一識別碼

### 6. **TEMP 工作表** - 溫度測試流程
**尺寸**: 13 行 x 16 列  
**作用**: 定義溫度相關測試的流程，結構與 MB 工作表類似但針對溫度測試優化

| 欄位名稱 | 功能說明 | 樣本值 | 數據類型 |
|----------|----------|--------|----------|
| **Index_93** | 測試步驟索引 | 101, 102, 103... | 序號 |
| **Phase** | 測試階段 | 1.0, 2.0, 3.0 | 階段標識 |
| **Title** | 測試階段標題 | CheckRoute, BOOTUP, Check SIM CARD | 階段名稱 |
| **Send** | 發送指令 | :ShowISN,"*(ISN)", :SfCheckRoute | 測試指令 |
| **Reply** | 預期回應 | 0 (成功) | 回應值 |
| **EndPrompt** | 結束提示符 | @root | 提示符 |
| **Waiting** | 等待時間 (毫秒) | 2000, 10000, 5000 | 時間參數 |
| **ExecMode** | 執行模式 | 1, 8 | 執行控制 |
| **TestID** | 測試項目 ID | B7PL025, OTCH013 | 測試標識 |

**欄位功能詳解**:
- **Index_93**: 溫度測試步驟的順序編號
- **Phase**: 溫度測試的階段分類
- **Title**: 溫度測試階段的描述名稱
- **Send**: 溫度測試的具體指令
- **Reply**: 溫度測試的預期回應
- **EndPrompt**: 溫度測試結束的提示符
- **Waiting**: 溫度測試的等待時間
- **ExecMode**: 溫度測試的執行模式
- **TestID**: 溫度測試項目的識別碼

---

## 🔧 腳本結構特點

### 1. **模組化設計**
- **Properties**: 腳本基本配置
- **DUTs**: 設備連接配置
- **Switch**: 開關設備配置
- **Instrument**: 測試儀器配置
- **MB/TEMP**: 具體測試流程

### 2. **測試流程邏輯**
- **階段化測試**: 通過 Phase 欄位區分不同測試階段
- **指令驅動**: Send 欄位定義具體測試指令
- **結果驗證**: Reply 和 Validation 欄位確保測試正確性
- **執行控制**: ExecMode 和 Waiting 欄位控制執行方式

### 3. **靈活性設計**
- **變數支援**: 使用 *$(變數名) 格式支援動態參數
- **多設備支援**: 支援多種測試儀器和連接方式
- **可擴展性**: 通過 DLL 驅動支援新設備

---

## 🤖 AI 整合應用

### 1. **腳本理解與分析**
- **結構識別**: AI 可以識別腳本的整體結構和組織方式
- **欄位映射**: 理解每個欄位的功能和作用
- **流程分析**: 分析測試流程的邏輯和順序

### 2. **腳本生成與優化**
- **模板生成**: 基於分析結果生成新的測試腳本
- **參數優化**: 優化測試參數和等待時間
- **流程改進**: 改進測試流程的效率和可靠性

### 3. **錯誤診斷與修復**
- **問題識別**: 識別腳本中的潛在問題
- **自動修復**: 自動修復常見的腳本錯誤
- **建議生成**: 提供腳本改進的建議

### 4. **測試流程管理**
- **依賴分析**: 分析測試步驟之間的依賴關係
- **資源分配**: 優化測試資源的使用
- **進度追蹤**: 追蹤測試進度和結果

---

## 📈 腳本統計摘要

### 工作表統計
| 工作表名稱 | 行數 | 列數 | 非空單元格 | 主要功能 |
|------------|------|------|------------|----------|
| Properties | 3 | 2 | 6 | 腳本屬性配置 |
| DUTs | 2 | 16 | 20 | 被測設備配置 |
| Switch | 1 | 7 | 6 | 開關設備配置 |
| Instrument | 40 | 9 | 243 | 測試儀器配置 |
| MB | 159 | 16 | 1064 | 主機板測試流程 |
| TEMP | 13 | 16 | 89 | 溫度測試流程 |

### 功能覆蓋
- **測試類型**: 主機板測試、溫度測試
- **儀器支援**: 40種測試儀器
- **連接方式**: 多種通訊協議 (APP, SSH, UART, GPIB)
- **測試步驟**: 172個測試步驟 (MB: 159 + TEMP: 13)
- **驗證機制**: 完整的結果驗證和錯誤處理

---

## 🎯 使用建議

### 1. **腳本開發**
- 遵循現有的欄位結構和命名規範
- 使用變數引用提高腳本的可維護性
- 合理設定等待時間和執行模式

### 2. **腳本維護**
- 定期檢查和更新儀器配置
- 驗證測試步驟的邏輯和順序
- 監控測試結果和錯誤率

### 3. **腳本擴展**
- 新增測試項目時保持結構一致性
- 支援新儀器時更新驅動程序配置
- 擴展測試功能時考慮向後相容性

---

## 🔗 相關資源

### 1. **腳本文件**
- [VALO360_TestFlow_20250318_MB_ER2.xlsx](../Centimani DOC/scripe_EXCEL/VALO360/VALO360_TestFlow_20250318_MB_ER2.xlsx) - 原始腳本文件
- [analyze_valo360_script.py](../Centimani DOC/scripe_EXCEL/VALO360/analyze_valo360_script.py) - 腳本分析工具

### 2. **分析報告**
- [VALO360_analysis_report_VALO360_TestFlow_20250318_MB_ER2.json](../Centimani DOC/scripe_EXCEL/VALO360/VALO360_analysis_report_VALO360_TestFlow_20250318_MB_ER2.json) - 詳細分析報告

### 3. **相關文檔**
- [SCRIPT_EXAMPLES_REFERENCE_FOR_AI.md](SCRIPT_EXAMPLES_REFERENCE_FOR_AI.md) - 腳本範例參考
- [AI_REFERENCE_INDEX.json](AI_REFERENCE_INDEX.json) - AI 參考索引

---

## 📝 版本更新記錄

### v1.0 (2025-01-XX)
- 初始版本創建
- 完成 VALO360 腳本結構分析
- 建立欄位功能映射表
- 提供 AI 整合應用指南

---

*本文件最後更新於 2025-01-XX，如有疑問或需要更新，請聯繫開發團隊。* 