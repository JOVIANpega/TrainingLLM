# Centimani AI腳本生成邏輯參考
## Centimani AI Script Generation Logic Reference

### 📋 文件概述

本文檔基於現有的JSON和Markdown分析文件，詳細整理了Centimani腳本生成的關聯性、邏輯模式和AI腳本生成的最佳實踐。透過分析52個腳本的結構特徵，建立了完整的腳本生成邏輯體系。

**版本**: 1.0.0  
**創建日期**: 2025-08-12  
**數據來源**: 52個腳本的JSON和Markdown分析文件  
**分析狀態**: 🔍 基於現有分析結果的邏輯整理

---

## 🎯 腳本分析數據基礎

### **數據來源統計**
- **總腳本數量**: 52個
- **專案數量**: 5個 (KANGAROO, VALO360, RAPTOR, Kilimanjaro, ZEBRA)
- **總工作表數**: 314個
- **總行數**: 27,556行
- **分析文件**: JSON格式詳細分析 + Markdown格式摘要

### **專案腳本分佈**
| 專案名稱 | 腳本數量 | 工作表數 | 總行數 | 複雜度分佈 | 測試覆蓋 |
|---------|---------|---------|--------|-----------|----------|
| **KANGAROO** | 20 | 120 | 19,062 | 中等:18, 複雜:2 | 全面:10, 功能:8, 基本:2 |
| **VALO360** | 20 | 114 | 3,518 | 中等:20 | 功能:14, 基本:6 |
| **RAPTOR** | 4 | 28 | 2,444 | 複雜:4 | 全面:4 |
| **Kilimanjaro** | 2 | 18 | 1,224 | 複雜:2 | 全面:2 |
| **ZEBRA** | 6 | 34 | 1,308 | 中等:6 | 功能:6 |

---

## 🔍 腳本結構關聯性分析

### **1. 工作表結構關聯性**

#### **標準工作表組合模式**
```
標準工作表組合 = {
    "必須工作表": ["Properties", "Instrument", "Switch", "DUTs"],
    "測試工作表": ["測試流程", "測試項目", "結果驗證"],
    "配置工作表": ["參數設定", "校準參數", "環境配置"],
    "可選工作表": ["日誌記錄", "統計報告", "錯誤處理"]
}
```

#### **專案特定工作表模式**
```
KANGAROO專案模式:
    - 必須: Properties, Instrument, Switch, DUTs
    - 測試: WiFi&5GOTA, PathLoss, 主機板測試, 韌體升級
    - 配置: 多設備配置, 儀器參數, 校準設定

VALO360專案模式:
    - 必須: Properties, DUTs, Switch, Instrument
    - 測試: MB, TEMP, OQC檢查, IMU測試, POE測試
    - 配置: 功能檢查配置, 測試參數設定

RAPTOR專案模式:
    - 必須: Properties, Instrument, Switch, DUTs
    - 測試: 全面測試流程, 夾具測試驗證
    - 配置: 複雜測試配置, 多儀器整合

Kilimanjaro專案模式:
    - 必須: Properties, Instrument, Switch, DUTs
    - 測試: LED測試, 光學特性驗證
    - 配置: LED測試參數, 光學校準設定

ZEBRA專案模式:
    - 必須: Properties, Instrument, Switch, DUTs
    - 測試: WiFi測試, 基本功能測試
    - 配置: WiFi測試參數, 基本功能配置
```

### **2. 欄位結構關聯性**

#### **Properties工作表標準欄位**
```
標準欄位結構 = {
    "Name": "配置項目名稱",
    "Value": "配置項目數值"
}

標準配置項目 = [
    "Version - 腳本版本號",
    "Creator - 創建者",
    "FailCount - 失敗計數",
    "Project_Name - 專案名稱",
    "Test_Environment - 測試環境",
    "DUT_Count - 設備數量"
]
```

#### **Instrument工作表標準欄位**
```
標準欄位結構 = {
    "Mount": "儀器掛載點",
    "Name": "儀器名稱",
    "Sub": "子儀器編號",
    "ControlDLL": "控制DLL檔案",
    "Settings": "儀器設定參數",
    "Functions": "儀器功能",
    "Version": "儀器版本",
    "Switch": "切換設定",
    "Desc": "儀器描述"
}

儀器類型分類 = {
    "電源儀器": ["IPOWER2401", "電源供應器"],
    "網路儀器": ["OSP120", "NFT分析儀"],
    "光學儀器": ["FeasaLED", "LED分析儀"],
    "通訊儀器": ["IPRO800", "通訊測試儀"],
    "測試儀器": ["測試夾具", "測試設備"]
}
```

#### **Switch工作表標準欄位**
```
標準欄位結構 = {
    "連接設定": "設備連接配置",
    "路徑管理": "測試路徑設定",
    "狀態控制": "開關狀態管理"
}

連接模式 = {
    "單設備": "單一設備測試連接",
    "多設備": "多設備並行測試連接",
    "串聯": "設備串聯測試連接",
    "並聯": "設備並聯測試連接"
}
```

#### **DUTs工作表標準欄位**
```
標準欄位結構 = {
    "Load": "載入狀態",
    "DUT Name": "設備名稱",
    "Station": "測試站別",
    "Parameter": "測試參數",
    "SFIS_DeviceID": "SFIS設備ID",
    "ScanBarcode": "條碼掃描設定",
    "Connection": "連接配置 (多個連接點)"
}

設備配置模式 = {
    "單設備": "單一設備測試配置",
    "多設備": "多設備並行測試配置",
    "設備鏈": "設備鏈式測試配置"
}
```

---

## 🤖 AI腳本生成邏輯模式

### **1. 腳本類型識別邏輯**

#### **腳本類型判斷矩陣**
```
腳本類型判斷 = {
    "KANGAROO_SCRIPT": {
        "條件": "專案名稱 == 'KANGAROO'",
        "特徵": ["多設備測試", "WiFi/BT校準", "韌體升級", "主機板測試"],
        "複雜度": "中等到複雜",
        "工作表數": "5-6個"
    },
    "VALO360_SCRIPT": {
        "條件": "專案名稱 == 'VALO360'",
        "特徵": ["功能檢查", "OQC檢查", "IMU測試", "POE測試"],
        "複雜度": "中等",
        "工作表數": "5-6個"
    },
    "RAPTOR_SCRIPT": {
        "條件": "專案名稱 == 'RAPTOR'",
        "特徵": ["全面測試", "夾具測試", "複雜測試邏輯"],
        "複雜度": "複雜",
        "工作表數": "7個"
    },
    "KILIMANJARO_SCRIPT": {
        "條件": "專案名稱 == 'Kilimanjaro'",
        "特徵": ["LED測試", "光學特性", "專用測試"],
        "複雜度": "複雜",
        "工作表數": "9個"
    },
    "ZEBRA_SCRIPT": {
        "條件": "專案名稱 == 'ZEBRA'",
        "特徵": ["WiFi測試", "基本功能", "簡潔流程"],
        "複雜度": "中等",
        "工作表數": "5-6個"
    }
}
```

### **2. 工作表生成邏輯**

#### **工作表生成決策樹**
```
工作表生成決策樹:
    IF 腳本類型 == "KANGAROO_SCRIPT" THEN
        生成工作表 = ["Properties", "Instrument", "Switch", "DUTs", "測試流程", "配置頁面"]
    ELSE IF 腳本類型 == "VALO360_SCRIPT" THEN
        生成工作表 = ["Properties", "DUTs", "Switch", "Instrument", "測試頁面", "配置頁面"]
    ELSE IF 腳本類型 == "RAPTOR_SCRIPT" THEN
        生成工作表 = ["Properties", "Instrument", "Switch", "DUTs", "測試流程", "夾具配置", "結果頁面"]
    ELSE IF 腳本類型 == "KILIMANJARO_SCRIPT" THEN
        生成工作表 = ["Properties", "Instrument", "Switch", "DUTs", "LED測試", "光學配置", "校準頁面", "結果頁面"]
    ELSE IF 腳本類型 == "ZEBRA_SCRIPT" THEN
        生成工作表 = ["Properties", "Instrument", "Switch", "DUTs", "測試頁面"]
    END IF
```

#### **工作表內容生成邏輯**
```
Properties工作表生成:
    FOR 每個標準配置項目 IN 標準配置項目:
        IF 專案需要此配置 THEN
            添加配置項目
            設定預設值
        END IF
    END FOR

Instrument工作表生成:
    FOR 每個需要的儀器類型 IN 儀器類型分類:
        IF 腳本需要此儀器 THEN
            生成儀器配置行
            設定標準參數
        END IF
    END FOR

Switch工作表生成:
    IF 多設備測試 THEN
        生成多設備連接配置
    ELSE
        生成單設備連接配置
    END IF

DUTs工作表生成:
    IF 多設備測試 THEN
        生成多設備配置行
    ELSE
        生成單設備配置行
    END IF
```

### **3. 測試流程生成邏輯**

#### **測試Phase生成模式**
```
標準測試Phase結構 = [
    "Phase 1: 系統初始化 (Login, 環境檢查)",
    "Phase 2: 版本檢查 (韌體版本, 軟體版本)",
    "Phase 3: 基本連通性測試 (Route, 通訊)",
    "Phase 4: 系統功能檢查 (IPLAS, SFIS, 基本功能)",
    "Phase 5: 核心測試項目 (主要測試內容)",
    "Phase 6: 結果驗證和報告 (數據驗證, 結果輸出)"
]

專案特定Phase調整:
    KANGAROO專案: 添加WiFi/BT校準Phase, 韌體升級Phase
    VALO360專案: 添加功能檢查Phase, OQC檢查Phase
    RAPTOR專案: 添加夾具測試Phase, 全面驗證Phase
    Kilimanjaro專案: 添加LED測試Phase, 光學校準Phase
    ZEBRA專案: 添加WiFi測試Phase, 基本功能Phase
```

#### **測試項目生成邏輯**
```
測試項目生成 = {
    "系統初始化": {
        "Send": "登入指令",
        "Reply": "登入回應格式",
        "Validation": "登入狀態檢查"
    },
    "版本檢查": {
        "Send": "版本查詢指令",
        "Reply": "版本號格式",
        "Validation": "版本格式驗證"
    },
    "WiFi測試": {
        "Send": "WiFi連接指令",
        "Reply": "連接狀態回應",
        "Validation": "連接成功驗證"
    },
    "藍牙測試": {
        "Send": "藍牙配對指令",
        "Reply": "配對狀態回應",
        "Validation": "配對成功驗證"
    },
    "功能檢查": {
        "Send": "功能測試指令",
        "Reply": "功能回應格式",
        "Validation": "功能正常驗證"
    }
}
```

---

## 🔧 腳本生成具體操作指南

### **步驟1: 腳本類型識別**
```
腳本類型識別流程:
    1. 分析用戶需求 (專案類型、測試功能、複雜度要求)
    2. 匹配腳本類型判斷矩陣
    3. 確定腳本類型和特徵
    4. 選擇對應的生成模板
```

### **步驟2: 工作表結構生成**
```
工作表生成流程:
    1. 根據腳本類型選擇工作表組合
    2. 生成必須工作表 (Properties, Instrument, Switch, DUTs)
    3. 生成專案特定工作表
    4. 設定工作表順序和依賴關係
```

### **步驟3: 欄位內容填充**
```
欄位內容填充流程:
    1. 根據腳本類型選擇欄位模板
    2. 填充標準欄位內容
    3. 調整專案特定欄位
    4. 驗證欄位完整性和一致性
```

### **步驟4: 測試流程生成**
```
測試流程生成流程:
    1. 選擇標準測試Phase結構
    2. 根據專案需求調整Phase內容
    3. 生成測試項目和驗證邏輯
    4. 設定執行模式和錯誤處理
```

### **步驟5: 品質驗證**
```
品質驗證流程:
    1. 檢查工作表完整性
    2. 驗證欄位依賴關係
    3. 確認測試邏輯一致性
    4. 測試腳本可執行性
```

---

## 📊 腳本生成成功標準

### **必須滿足的條件**
1. ✅ **腳本類型識別正確**: 與用戶需求匹配
2. ✅ **工作表結構完整**: 包含所有必須工作表
3. ✅ **欄位內容一致**: 與專案標準格式一致
4. ✅ **測試流程完整**: Phase結構和邏輯完整
5. ✅ **專案特徵體現**: 體現專案特定的功能和配置

### **品質評估指標**
- **完整性**: 100%包含所有必須項目
- **一致性**: 與現有腳本格式完全一致
- **專案適配性**: 符合專案特定的需求和特徵
- **可執行性**: 腳本能夠正常運行
- **可維護性**: 結構清晰，易於維護和擴展

---

## 🚀 適用範圍和擴展性

### **測試類型覆蓋**
- **硬體測試**: 電壓、電流、溫度、振動、EMC等
- **軟體測試**: 版本檢查、功能驗證、性能測試等
- **通訊測試**: WiFi、藍牙、蜂窩網路、有線網路等
- **系統測試**: 開機、關機、重啟、故障恢復等
- **環境測試**: 溫度、濕度、壓力、輻射等

### **專案類型覆蓋**
- **現有專案**: KANGAROO、VALO360、RAPTOR、Kilimanjaro、ZEBRA
- **新專案**: 適用於未來新增的任何專案類型
- **跨專案**: 支援不同專案間的腳本邏輯借鑒和重構

### **擴展性設計**
- **模組化架構**: 支援功能模組的獨立開發和整合
- **參數化配置**: 支援不同測試需求的動態配置
- **模板化生成**: 支援新腳本的快速生成和定製
- **品質控制**: 支援腳本品質的自動化驗證和優化

---

## 🔗 相關文檔

- [AI腳本邏輯分析主索引](AI_SCRIPT_LOGIC_ANALYSIS_MAIN_INDEX.md)
- [AI腳本生成邏輯總覽](AI_SCRIPT_GENERATION_LOGIC_OVERVIEW.md)
- [腳本分析結果目錄](腳本分析結果/)
- [AI腳本邏輯分析目錄](ai_script_logic_directory/)

---

## 📝 更新記錄

### 版本 1.0.0 (2025-08-12)
- 🎯 **基於現有分析**: 基於52個腳本的JSON和Markdown分析文件
- 🔍 **關聯性分析**: 詳細分析腳本結構關聯性和生成邏輯
- 🤖 **AI生成邏輯**: 建立完整的腳本生成邏輯體系
- 📋 **操作指南**: 提供詳細的腳本生成操作步驟
- ✅ **品質標準**: 建立腳本生成的品質評估標準
- 🌐 **適用範圍**: 明確適用範圍和擴展性設計

---

*本文檔基於現有的腳本分析結果，建立了完整的AI腳本生成邏輯參考體系，為腳本生成提供準確的邏輯指導。* 