# VALO360腳本完整工作表分析報告

## 📋 報告資訊
- **分析日期**: 2025年8月12日
- **分析工具**: 統一腳本分析器 (unified_centimani_script_analyzer.py)
- **分析檔案**: `VALO360_TestFlow_20250318_MB_ER2.xlsx`
- **專案類型**: VALO360主機板功能測試
- **報告版本**: v1.0
- **分析範圍**: 所有6個工作表

## 🎯 腳本整體概覽

### 基本統計
- **總工作表數**: 6個
- **總行數**: 218行
- **總列數**: 256列
- **總命令數**: 172個
- **CLI命令**: 64個 (37.21%)
- **設備調用**: 108個 (62.79%)
- **複雜度分數**: 69/100

### 工作表類型分布
- **properties**: 1個 (Properties)
- **instrument**: 4個 (DUTs, Instrument, MB, TEMP)
- **switch**: 1個 (Switch)

## 🔍 各工作表深度分析

### 1. Properties 工作表

#### **基本資訊**
- **類型**: properties (屬性配置)
- **行數**: 3行
- **列數**: 2列
- **有數據**: 是

#### **欄位結構**
```
Name | Value
-----|-------
[屬性名稱] | [屬性值]
```

#### **功能分析**
- **用途**: 定義腳本的基本屬性和配置
- **內容**: 可能包含版本、專案名稱、創建日期等
- **重要性**: 提供腳本的基本識別信息

#### **設計邏輯**
- **標準化**: 使用Name-Value對的標準格式
- **可讀性**: 屬性名稱清晰明確
- **擴展性**: 可以輕鬆添加新的屬性

#### **新腳本生成規則**
- **必要屬性**: Version, Project, CreateDate, Author
- **格式**: 使用標準的Name-Value對格式
- **內容**: 根據專案需求設定具體值

---

### 2. DUTs 工作表

#### **基本資訊**
- **類型**: instrument (設備配置)
- **行數**: 2行
- **列數**: 18列
- **有數據**: 是

#### **欄位結構**
```
Load | DUT Name | Station | Parameter | SFIS_DeviceID | ScanBarcode | Connection1-10 | [空列]
-----|----------|---------|-----------|----------------|-------------|-----------------|-------
[載入] | [設備名] | [站別] | [參數] | [SFIS設備ID] | [條碼規則] | [連接設定1] | [空]
```

#### **功能分析**
- **用途**: 定義被測設備(DUT)的配置和連接設定
- **內容**: 設備載入控制、站別設定、連接配置等
- **重要性**: 腳本執行的基礎配置

#### **關鍵欄位解析**

##### **Load**
- **功能**: 控制是否載入該DUT
- **值**: true/false
- **設計邏輯**: 允許選擇性載入不同的DUT配置

##### **DUT Name**
- **功能**: 設備名稱識別
- **值**: 專案或型號名稱
- **設計邏輯**: 提供設備的唯一識別

##### **Station**
- **功能**: 測試站別設定
- **值**: 站別名稱,跳過確認標誌
- **設計邏輯**: 控制測試流程和用戶交互

##### **Parameter**
- **功能**: 傳遞給測試腳本的參數
- **值**: 變數引用或固定值
- **設計邏輯**: 實現配置的動態傳遞

##### **SFIS_DeviceID**
- **功能**: SFIS系統的設備識別碼
- **值**: 唯一的設備ID
- **設計邏輯**: 與生產系統的整合

##### **ScanBarcode**
- **功能**: 條碼掃描規則設定
- **值**: {名稱,長度,模式}格式
- **設計邏輯**: 自動化條碼掃描和驗證

##### **Connection1-10**
- **功能**: 最多10個連接設定
- **值**: 連接類型和參數
- **設計邏輯**: 支援多種連接類型的靈活配置

#### **設計邏輯分析**
- **靈活性**: 支援多DUT配置，可選擇性載入
- **標準化**: 使用標準的連接格式和參數引用
- **整合性**: 與SFIS系統和條碼掃描整合
- **擴展性**: 支援多達10個連接配置

#### **新腳本生成規則**
- **DUT配置**: 根據測試需求設定Load和DUT Name
- **站別設定**: 設定適當的Station名稱和跳過標誌
- **參數引用**: 使用Global.ini中的變數引用
- **連接設定**: 根據硬體配置設定連接參數
- **SFIS整合**: 設定正確的設備ID和條碼規則

---

### 3. Switch 工作表

#### **基本資訊**
- **類型**: switch (開關配置)
- **行數**: 1行
- **列數**: 7列
- **有數據**: 是

#### **欄位結構**
```
Mount | Name | ControlDLL | Settings | Version | Loss | Desc
------|------|------------|----------|---------|------|-----
[掛載] | [名稱] | [控制庫] | [設定] | [版本] | [損耗] | [描述]
```

#### **功能分析**
- **用途**: 定義開關設備的配置和控制
- **內容**: 開關掛載、控制庫、設定參數等
- **重要性**: 控制測試路徑和信號切換

#### **關鍵欄位解析**

##### **Mount**
- **功能**: 指定開關掛載的站別
- **值**: 站別名稱
- **設計邏輯**: 控制開關在特定站別的可用性

##### **Name**
- **功能**: 開關設備名稱
- **值**: 唯一的開關識別名稱
- **設計邏輯**: 在測試腳本中引用開關

##### **ControlDLL**
- **功能**: 開關控制庫檔案
- **值**: DLL檔案名稱
- **設計邏輯**: 提供開關控制的軟體介面

##### **Settings**
- **功能**: 開關的具體設定參數
- **值**: 由開關開發者定義的參數
- **設計邏輯**: 配置開關的具體行為

##### **Version**
- **功能**: 開關控制庫版本
- **值**: 版本號碼
- **設計邏輯**: 確保版本相容性

##### **Loss**
- **功能**: 開關的損耗值
- **值**: 數值或空值
- **設計邏輯**: 補償信號損耗

##### **Desc**
- **功能**: 開關設備描述
- **值**: 人類可讀的描述
- **設計邏輯**: 提供設備識別信息

#### **設計邏輯分析**
- **模組化**: 每個開關獨立配置
- **標準化**: 使用統一的配置格式
- **版本控制**: 確保軟體相容性
- **損耗補償**: 支援信號品質優化

#### **新腳本生成規則**
- **開關配置**: 根據測試需求設定開關參數
- **控制庫**: 選擇適當的ControlDLL
- **設定參數**: 根據硬體規格設定Settings
- **版本管理**: 確保ControlDLL版本相容
- **損耗設定**: 根據實際測試結果設定Loss值

---

### 4. Instrument 工作表

#### **基本資訊**
- **類型**: instrument (儀器配置)
- **行數**: 40行
- **列數**: 9列
- **有數據**: 是

#### **欄位結構**
```
Mount | Name | Sub | ControlDLL | Settings | Functions | Version | Switch | Desc
------|------|-----|------------|----------|-----------|---------|--------|-----
[掛載] | [名稱] | [子設備] | [控制庫] | [設定] | [功能] | [版本] | [開關] | [描述]
```

#### **功能分析**
- **用途**: 定義測試儀器的配置和功能
- **內容**: 儀器掛載、控制庫、功能列表、開關配置等
- **重要性**: 提供測試所需的儀器支援

#### **關鍵欄位解析**

##### **Mount**
- **功能**: 指定儀器掛載的站別
- **值**: 站別名稱，可多個用逗號分隔
- **設計邏輯**: 控制儀器在不同站別的可用性

##### **Name**
- **功能**: 儀器設備名稱
- **值**: 唯一的儀器識別名稱
- **設計邏輯**: 在測試腳本中引用儀器

##### **Sub**
- **功能**: 標識是否為子設備
- **值**: 1表示子設備，空值表示主設備
- **設計邏輯**: 支援設備的層次結構

##### **ControlDLL**
- **功能**: 儀器控制庫檔案
- **值**: DLL檔案名稱
- **設計邏輯**: 提供儀器控制的軟體介面

##### **Settings**
- **功能**: 儀器的具體設定參數
- **值**: 由儀器開發者定義的參數
- **設計邏輯**: 配置儀器的具體行為

##### **Functions**
- **功能**: 儀器支援的功能列表
- **值**: 功能名稱，多個用逗號分隔
- **設計邏輯**: 定義儀器的可用功能

##### **Version**
- **功能**: 儀器控制庫版本
- **值**: 版本號碼
- **設計邏輯**: 確保版本相容性

##### **Switch**
- **功能**: 與儀器連接的開關配置
- **值**: 開關名稱和連接設定
- **設計邏輯**: 實現儀器與開關的配線

##### **Desc**
- **功能**: 儀器設備描述
- **值**: 人類可讀的描述
- **設計邏輯**: 提供設備識別信息

#### **設計邏輯分析**
- **模組化**: 每個儀器獨立配置
- **功能導向**: 明確定義支援的功能
- **開關整合**: 與開關系統緊密整合
- **版本管理**: 確保軟體相容性
- **多站支援**: 支援儀器在多個站別使用

#### **新腳本生成規則**
- **儀器選擇**: 根據測試需求選擇適當的儀器
- **功能配置**: 確保Functions欄位包含所需功能
- **開關配線**: 正確設定Switch欄位的連接關係
- **版本檢查**: 確保ControlDLL版本相容
- **設定優化**: 根據測試要求優化Settings參數

---

### 5. MB 工作表 (主要測試流程)

#### **基本資訊**
- **類型**: instrument (主要測試流程)
- **行數**: 159行
- **列數**: 256列
- **有數據**: 是

#### **功能分析**
- **用途**: 定義主機板功能測試的完整流程
- **內容**: 系統初始化、模型識別、功能測試、IMU測試等
- **重要性**: 腳本的核心測試邏輯

#### **Phase分布分析**
- **Phase 0**: 系統初始化 (登入、SFIS檢查、網路測試)
- **Phase 1-9**: 基本功能測試 (模型識別、硬體測試)
- **Phase 10-19**: 進階功能測試 (IMU、按鈕測試)
- **Phase 20+**: 特殊測試驗證
- **Phase 97**: 測試結束處理
- **Phase -1**: 特殊處理邏輯

#### **命令類型分析**
- **CLI命令**: 61個 (38.4%)
  - 與DUT通訊
  - 讀取硬體狀態
  - 設定硬體參數
- **設備調用**: 98個 (61.6%)
  - 控制測試設備
  - 執行系統功能
  - 管理變數和狀態

#### **執行模式分析**
- **ExecMode 0**: 正常執行模式
- **ExecMode 1**: 總是執行
- **ExecMode 2**: 重試模式
- **ExecMode 4**: 條件執行
- **ExecMode 6**: 失敗時執行
- **ExecMode 8**: SFIS啟用時執行
- **ExecMode 9**: 特殊執行模式

#### **設計邏輯分析**
- **階段化設計**: 使用Phase實現邏輯分組
- **條件執行**: 使用ExecMode實現複雜邏輯
- **變數管理**: 使用全域變數實現數據共享
- **錯誤處理**: 支援重試和條件分支
- **用戶交互**: 使用確認框和提示

#### **新腳本生成規則**
- **Phase設計**: 按邏輯分組設計Phase值
- **命令選擇**: 根據測試需求選擇CLI或設備調用
- **執行控制**: 使用適當的ExecMode實現邏輯
- **變數設計**: 合理使用Ref和Validation欄位
- **錯誤處理**: 設計適當的重試和分支邏輯

---

### 6. TEMP 工作表 (溫度測試流程)

#### **基本資訊**
- **類型**: instrument (溫度測試流程)
- **行數**: 13行
- **列數**: 256列
- **有數據**: 是

#### **功能分析**
- **用途**: 定義溫度相關的測試流程
- **內容**: 溫度感測器測試、溫度監控等
- **重要性**: 溫度測試的專用流程

#### **Phase分布分析**
- **Phase數量**: 4個
- **測試項目**: 13個命令

#### **命令類型分析**
- **CLI命令**: 3個 (23.1%)
- **設備調用**: 10個 (76.9%)

#### **設計邏輯分析**
- **專用流程**: 專門處理溫度相關測試
- **簡化設計**: 相比MB工作表，流程較為簡單
- **設備導向**: 主要使用設備調用而非CLI命令

#### **新腳本生成規則**
- **溫度測試**: 設計專門的溫度測試流程
- **設備整合**: 整合溫度感測器和監控設備
- **簡化流程**: 保持流程簡潔，專注於溫度測試
- **數據記錄**: 設計適當的溫度數據記錄和驗證

---

## 🧠 整體腳本邏輯理解

### 腳本架構設計

#### **分層結構**
1. **配置層**: Properties、DUTs、Switch、Instrument
2. **執行層**: MB、TEMP
3. **整合層**: 各工作表間的數據和邏輯整合

#### **工作流程**
1. **初始化**: Properties定義基本配置
2. **設備準備**: DUTs、Switch、Instrument配置硬體
3. **測試執行**: MB執行主要測試，TEMP執行專用測試
4. **結果處理**: 通過變數和驗證機制處理結果

### 設計原則

#### **模組化設計**
- 每個工作表專注於特定功能
- 工作表間通過標準介面整合
- 支援獨立配置和維護

#### **配置驅動**
- 使用配置檔案控制行為
- 支援動態參數設定
- 實現配置與邏輯分離

#### **靈活性設計**
- 支援多種執行模式
- 支援條件分支和重試
- 支援用戶交互和確認

## 📋 新腳本生成完整規則

### 1. 工作表結構設計

#### **必要工作表**
- **Properties**: 基本屬性配置
- **DUTs**: 設備配置
- **Switch**: 開關配置
- **Instrument**: 儀器配置
- **測試工作表**: 根據測試需求設計

#### **工作表順序**
```
Properties → DUTs → Switch → Instrument → 測試工作表1 → 測試工作表2 → ...
```

### 2. 配置工作表設計

#### **Properties工作表**
- 包含Version、Project、CreateDate、Author等基本屬性
- 使用標準的Name-Value對格式
- 支援擴展和自定義

#### **DUTs工作表**
- 設定Load、DUT Name、Station等基本配置
- 配置SFIS整合和條碼掃描
- 設定多個連接配置

#### **Switch工作表**
- 配置開關設備和控制庫
- 設定開關參數和損耗值
- 支援多站別掛載

#### **Instrument工作表**
- 配置測試儀器和功能
- 設定儀器參數和開關配線
- 支援多站別和多功能

### 3. 測試工作表設計

#### **Phase設計原則**
- **Phase 0**: 系統初始化
- **Phase 1-9**: 基本功能測試
- **Phase 10-19**: 進階功能測試
- **Phase 20+**: 特殊測試

#### **命令設計原則**
- **CLI命令**: 用於與DUT通訊
- **設備調用**: 用於控制測試設備
- **混合使用**: 根據測試需求選擇

#### **變數設計原則**
- **全域變數**: 使用$前綴，跨工作表共享
- **區域變數**: 使用普通名稱，工作表內使用
- **參數引用**: 使用Global.ini中的配置

### 4. 整合和驗證

#### **工作表整合**
- 確保工作表間的數據一致性
- 使用標準的變數引用格式
- 支援配置的動態更新

#### **驗證機制**
- 使用Validation欄位驗證結果
- 支援多種數據格式驗證
- 實現自動化的PASS/FAIL判斷

#### **錯誤處理**
- 使用ExecMode實現重試邏輯
- 支援條件分支和錯誤處理
- 提供用戶交互和確認機制

## 🔧 實用工具和最佳實踐

### 腳本分析工具
- **統一腳本分析器**: 深度分析腳本結構和邏輯
- **功能**: 識別工作表類型、分析命令分布、評估複雜度

### 腳本生成工具
- **統一腳本生成器**: 生成完整的腳本結構
- **功能**: 創建配置工作表、生成測試流程、整合所有組件

### 最佳實踐建議
1. **標準化設計**: 遵循標準的工作表結構和欄位格式
2. **模組化開發**: 將不同功能分離到不同工作表
3. **配置驅動**: 使用配置文件控制腳本行為
4. **錯誤處理**: 設計完善的錯誤處理和重試機制
5. **用戶體驗**: 提供清晰的提示和確認機制

## 📊 腳本品質評估

### 優點
1. **結構完整**: 包含所有必要的工作表類型
2. **設計清晰**: 工作表分工明確，邏輯清晰
3. **配置靈活**: 支援多種配置選項和參數設定
4. **整合良好**: 工作表間整合緊密，數據流暢
5. **擴展性強**: 支援新功能和工作表的添加

### 改進建議
1. **文檔完善**: 可以增加更詳細的配置說明
2. **錯誤處理**: 可以增加更多的錯誤處理邏輯
3. **日誌記錄**: 可以增加詳細的執行日誌記錄
4. **性能優化**: 可以優化大量數據的處理性能

## 🎯 總結

VALO360腳本是一個設計優秀的完整測試腳本，具有以下特點：

1. **完整的架構**: 從配置到執行的完整覆蓋
2. **清晰的結構**: 工作表分工明確，邏輯清晰
3. **靈活的配置**: 支援多種配置選項和參數設定
4. **良好的整合**: 工作表間整合緊密，數據流暢
5. **強的可擴展性**: 支援新功能和工作表的添加

這個腳本為VALO360專案的腳本開發提供了優秀的參考範例，其設計模式、架構原則和最佳實踐值得在其他專案中推廣應用。

---

*本報告基於VALO360_TestFlow_20250318_MB_ER2.xlsx腳本檔案的所有工作表，使用統一腳本分析器進行深度分析，為腳本開發和維護提供完整的參考指導。* 