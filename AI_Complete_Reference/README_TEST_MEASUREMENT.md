# æ¸¬è©¦é‡æ¸¬è…³æœ¬ä½¿ç”¨èªªæ˜

## ğŸ¯ è…³æœ¬æ¦‚è¿°

æ¸¬è©¦é‡æ¸¬è…³æœ¬æ˜¯ä¸€å€‹åŠŸèƒ½å®Œæ•´çš„æ¸¬è©¦å·¥å…·ï¼Œæä¾›ç‰ˆæœ¬è™Ÿç¢¼ç®¡ç†ã€é›»å£“é‡æ¸¬ã€è—ç‰™é‡æ¸¬å’Œå ±å‘Šç”ŸæˆåŠŸèƒ½ã€‚è©²è…³æœ¬å°ˆç‚ºæ¸¬è©¦ç’°å¢ƒè¨­è¨ˆï¼Œèƒ½å¤ è‡ªå‹•åŒ–æ¸¬è©¦æµç¨‹ä¸¦ç”Ÿæˆæ¨™æº–åŒ–çš„æ¸¬è©¦å ±å‘Šã€‚

## ğŸš€ ä¸»è¦åŠŸèƒ½

### 1. ç‰ˆæœ¬è™Ÿç¢¼ç®¡ç†
- **è‡ªå‹•ç‰ˆæœ¬æ§åˆ¶**: è‡ªå‹•ç”Ÿæˆå’Œç®¡ç†ç‰ˆæœ¬è³‡è¨Š
- **ç‰ˆæœ¬é¡å‹æ”¯æ´**: ä¸»ç‰ˆæœ¬ã€æ¬¡ç‰ˆæœ¬ã€ä¿®è£œç‰ˆæœ¬ã€å»ºç½®ç·¨è™Ÿ
- **è®Šæ›´æ­·å²è¨˜éŒ„**: å®Œæ•´çš„ç‰ˆæœ¬è®Šæ›´æ­·å²è¿½è¹¤
- **ç‰ˆæœ¬æè¿°ç®¡ç†**: æ¯å€‹ç‰ˆæœ¬çš„è©³ç´°æè¿°å’Œèªªæ˜

### 2. é›»å£“é‡æ¸¬
- **å¤šé€šé“æ”¯æ´**: æ”¯æ´å¤šå€‹é›»å£“é€šé“åŒæ™‚é‡æ¸¬
- **é«˜ç²¾åº¦æ¡æ¨£**: å¯é…ç½®çš„æ¡æ¨£ç‡å’Œç²¾åº¦
- **çµ±è¨ˆåˆ†æ**: è‡ªå‹•è¨ˆç®—å¹³å‡å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ¨™æº–å·®
- **å™ªè²æ¨¡æ“¬**: æ¨¡æ“¬çœŸå¯¦ç’°å¢ƒä¸­çš„é›»å£“å™ªè²

### 3. è—ç‰™é‡æ¸¬
- **è¨­å‚™æƒæ**: è‡ªå‹•æƒæå‘¨åœçš„è—ç‰™è¨­å‚™
- **é€£æ¥æ¸¬è©¦**: æ¸¬è©¦è—ç‰™è¨­å‚™çš„é€£æ¥ç©©å®šæ€§
- **å”è­°æ”¯æ´**: æ”¯æ´å¤šç¨®è—ç‰™å”è­°ï¼ˆHFPã€A2DPã€AVRCPã€GATTï¼‰
- **ä¿¡è™Ÿå¼·åº¦**: è¨˜éŒ„RSSIä¿¡è™Ÿå¼·åº¦æŒ‡æ¨™

### 4. å ±å‘Šç”Ÿæˆ
- **å¤šæ ¼å¼æ”¯æ´**: æ”¯æ´CSVå’ŒExcelæ ¼å¼è¼¸å‡º
- **è©³ç´°æ•¸æ“š**: åŒ…å«æ‰€æœ‰æ¸¬è©¦æ•¸æ“šå’Œçµ±è¨ˆè³‡è¨Š
- **æ ¼å¼åŒ–æ¨£å¼**: ç¾è§€çš„Excelå ±è¡¨æ¨£å¼
- **è‡ªå‹•åˆ†é¡**: æŒ‰æ¸¬è©¦é¡å‹è‡ªå‹•åˆ†é¡æ•¸æ“š

## ğŸ“‹ ç³»çµ±éœ€æ±‚

### Pythonç‰ˆæœ¬
- Python 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬

### ä¾è³´å¥—ä»¶
```
pandas>=1.3.0
openpyxl>=3.0.0
```

### å®‰è£ä¾è³´
```bash
pip install pandas openpyxl
```

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨

```python
from test_measurement_script import TestMeasurementScript

# å‰µå»ºæ¸¬è©¦è…³æœ¬å¯¦ä¾‹
script = TestMeasurementScript()

# åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶
test_summary = script.run_full_test_suite()

# æŸ¥çœ‹æ¸¬è©¦çµæœ
print(f"æ¸¬è©¦å®Œæˆï¼Œç”Ÿæˆå ±å‘Š: {test_summary['report_files']}")
```

### 2. é›»å£“æ¸¬è©¦

```python
# æ¸¬è©¦æŒ‡å®šé€šé“
voltage_results = script.run_voltage_tests(
    channels=[1, 2, 3],  # æ¸¬è©¦é€šé“
    duration=2.0          # æ¸¬è©¦æŒçºŒæ™‚é–“ï¼ˆç§’ï¼‰
)

# æŸ¥çœ‹æ¸¬è©¦çµæœ
for result in voltage_results:
    if result["status"] == "success":
        stats = result["statistics"]
        print(f"é€šé“ {result['channel']}: å¹³å‡é›»å£“ = {stats['average_voltage']}V")
```

### 3. è—ç‰™æ¸¬è©¦

```python
# åŸ·è¡Œè—ç‰™æƒæ
bluetooth_results = script.run_bluetooth_tests(
    scan_duration=15.0,      # æƒææ™‚é–“ï¼ˆç§’ï¼‰
    test_connections=True     # æ˜¯å¦æ¸¬è©¦é€£æ¥
)

# æŸ¥çœ‹æƒæçµæœ
for result in bluetooth_results:
    if "devices" in result:
        print(f"ç™¼ç¾ {len(result['devices'])} å€‹è—ç‰™è¨­å‚™")
```

### 4. ç‰ˆæœ¬ç®¡ç†

```python
# æŸ¥çœ‹ç•¶å‰ç‰ˆæœ¬
current_version = script.version_manager.get_version_string()
print(f"ç•¶å‰ç‰ˆæœ¬: {current_version}")

# å¢åŠ ç‰ˆæœ¬è™Ÿç¢¼
new_version = script.version_manager.increment_version(
    version_type="minor",           # ç‰ˆæœ¬é¡å‹ï¼šmajor/minor/patch
    description="æ–°å¢è—ç‰™æ¸¬è©¦åŠŸèƒ½"    # ç‰ˆæœ¬æè¿°
)
print(f"æ–°ç‰ˆæœ¬: {new_version}")
```

### 5. å ±å‘Šç”Ÿæˆ

```python
# ç”Ÿæˆå¤šæ ¼å¼å ±å‘Š
report_files = script.generate_reports(
    voltage_results,      # é›»å£“æ¸¬è©¦çµæœ
    bluetooth_results,    # è—ç‰™æ¸¬è©¦çµæœ
    output_formats=["csv", "xlsx"]  # è¼¸å‡ºæ ¼å¼
)

# æŸ¥çœ‹ç”Ÿæˆçš„å ±å‘Š
for format_type, file_path in report_files.items():
    print(f"{format_type.upper()} å ±å‘Š: {file_path}")
```

## ğŸ“Š è¼¸å‡ºæ ¼å¼

### CSVæ ¼å¼
- åŒ…å«æ‰€æœ‰æ¸¬è©¦æ•¸æ“šçš„è¡¨æ ¼æ ¼å¼
- æ”¯æ´ä¸­æ–‡ç·¨ç¢¼ï¼ˆUTF-8-BOMï¼‰
- é©åˆæ•¸æ“šåˆ†æå’Œè™•ç†

### Excelæ ¼å¼
- å¤šå·¥ä½œè¡¨çµæ§‹
- ç¾è§€çš„æ ¼å¼æ¨£å¼
- åŒ…å«ç‰ˆæœ¬è³‡è¨Šã€æ¸¬è©¦æ•¸æ“šã€æ‘˜è¦ç­‰

#### Excelå·¥ä½œè¡¨çµæ§‹
1. **ç‰ˆæœ¬è³‡è¨Š**: è…³æœ¬ç‰ˆæœ¬å’Œè®Šæ›´æ­·å²
2. **é›»å£“é‡æ¸¬**: é›»å£“æ¸¬è©¦çµæœå’Œçµ±è¨ˆæ•¸æ“š
3. **è—ç‰™é‡æ¸¬**: è—ç‰™æ¸¬è©¦çµæœå’Œè¨­å‚™è³‡è¨Š
4. **æ¸¬è©¦æ‘˜è¦**: æ¸¬è©¦æ¦‚æ³å’Œçµ±è¨ˆæ‘˜è¦

## âš™ï¸ é…ç½®é¸é …

### é›»å£“é‡æ¸¬é…ç½®
```python
# ä¿®æ”¹é›»å£“é‡æ¸¬åƒæ•¸
script.voltage_measurement.measurement_config.update({
    "voltage_range": (0.0, 12.0),    # é›»å£“ç¯„åœ
    "accuracy": 0.001,               # ç²¾åº¦
    "sampling_rate": 2000,           # æ¡æ¨£ç‡
    "measurement_time": 2.0          # é‡æ¸¬æ™‚é–“
})
```

### è—ç‰™é‡æ¸¬é…ç½®
```python
# ä¿®æ”¹è—ç‰™é‡æ¸¬åƒæ•¸
script.bluetooth_measurement.measurement_config.update({
    "scan_duration": 20.0,           # æƒææ™‚é–“
    "rssi_threshold": -70,           # RSSIé–¾å€¼
    "connection_timeout": 60.0,      # é€£æ¥è¶…æ™‚
    "supported_profiles": ["HFP", "A2DP"]  # æ”¯æ´å”è­°
})
```

### å ±å‘Šé…ç½®
```python
# ä¿®æ”¹å ±å‘Šè¼¸å‡ºç›®éŒ„
script.report_generator.output_dir = "custom_reports"

# ä¿®æ”¹å ±å‘Šæª”æ¡ˆåæ ¼å¼
script.report_generator.timestamp = "custom_format"
```

## ğŸ” æ¸¬è©¦å’Œé©—è­‰

### 1. ç°¡å–®æ¸¬è©¦
```bash
# åŸ·è¡Œç°¡å–®åŠŸèƒ½æ¸¬è©¦
python test_simple.py
```

### 2. å®Œæ•´æ¸¬è©¦
```bash
# åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶
python test_measurement_script.py
```

### 3. è‡ªå®šç¾©æ¸¬è©¦
```python
# å‰µå»ºè‡ªå®šç¾©æ¸¬è©¦
script = TestMeasurementScript()

# æ¸¬è©¦ç‰¹å®šåŠŸèƒ½
voltage_results = script.run_voltage_tests(channels=[1], duration=1.0)
bluetooth_results = script.run_bluetooth_tests(scan_duration=5.0)

# ç”Ÿæˆå ±å‘Š
reports = script.generate_reports(voltage_results, bluetooth_results)
```

## ğŸ“ æ—¥èªŒå’Œé™¤éŒ¯

### æ—¥èªŒæª”æ¡ˆ
- **æ¸¬è©¦æ—¥èªŒ**: `test_measurement.log`
- **æ—¥èªŒç´šåˆ¥**: INFOã€WARNINGã€ERROR
- **ç·¨ç¢¼æ ¼å¼**: UTF-8

### é™¤éŒ¯æ¨¡å¼
```python
import logging

# è¨­ç½®æ›´è©³ç´°çš„æ—¥èªŒç´šåˆ¥
logging.getLogger().setLevel(logging.DEBUG)

# æŸ¥çœ‹è©³ç´°åŸ·è¡Œè³‡è¨Š
script = TestMeasurementScript()
```

## ğŸš¨ å¸¸è¦‹å•é¡Œ

### 1. ä¾è³´å¥—ä»¶å•é¡Œ
**å•é¡Œ**: å°å…¥pandasæˆ–openpyxlå¤±æ•—
**è§£æ±º**: å®‰è£ä¾è³´å¥—ä»¶
```bash
pip install pandas openpyxl
```

### 2. æ¬Šé™å•é¡Œ
**å•é¡Œ**: ç„¡æ³•å‰µå»ºå ±å‘Šç›®éŒ„æˆ–æª”æ¡ˆ
**è§£æ±º**: æª¢æŸ¥ç›®éŒ„æ¬Šé™ï¼Œç¢ºä¿æœ‰å¯«å…¥æ¬Šé™

### 3. ç·¨ç¢¼å•é¡Œ
**å•é¡Œ**: ä¸­æ–‡é¡¯ç¤ºäº‚ç¢¼
**è§£æ±º**: ç¢ºä¿ä½¿ç”¨UTF-8ç·¨ç¢¼ï¼ŒExcelå ±å‘Šæœƒè‡ªå‹•è™•ç†ç·¨ç¢¼

### 4. è¨˜æ†¶é«”å•é¡Œ
**å•é¡Œ**: å¤§é‡æ•¸æ“šè™•ç†æ™‚è¨˜æ†¶é«”ä¸è¶³
**è§£æ±º**: åˆ†æ‰¹è™•ç†æ•¸æ“šï¼Œæˆ–æ¸›å°‘æ¡æ¨£æ•¸é‡

## ğŸ”§ æ“´å±•å’Œè‡ªå®šç¾©

### 1. æ·»åŠ æ–°çš„é‡æ¸¬é¡å‹
```python
class CustomMeasurement:
    def __init__(self):
        self.config = {}
    
    def measure(self):
        # å¯¦ç¾è‡ªå®šç¾©é‡æ¸¬é‚è¼¯
        pass

# é›†æˆåˆ°ä¸»è…³æœ¬
script.custom_measurement = CustomMeasurement()
```

### 2. è‡ªå®šç¾©å ±å‘Šæ ¼å¼
```python
class CustomReportGenerator:
    def generate_custom_report(self, data):
        # å¯¦ç¾è‡ªå®šç¾©å ±å‘Šæ ¼å¼
        pass

# æ›¿æ›é è¨­å ±å‘Šç”Ÿæˆå™¨
script.report_generator = CustomReportGenerator()
```

### 3. æ·»åŠ æ–°çš„è¼¸å‡ºæ ¼å¼
```python
def generate_json_report(self, data):
    # å¯¦ç¾JSONæ ¼å¼è¼¸å‡º
    import json
    with open("report.json", "w") as f:
        json.dump(data, f, indent=2)
```

## ğŸ“š æœ€ä½³å¯¦è¸

### 1. æ¸¬è©¦æµç¨‹
- å…ˆåŸ·è¡Œç°¡å–®æ¸¬è©¦é©—è­‰åŸºæœ¬åŠŸèƒ½
- æ ¹æ“šå¯¦éš›éœ€æ±‚èª¿æ•´é…ç½®åƒæ•¸
- å®šæœŸåŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶
- ä¿å­˜é‡è¦çš„æ¸¬è©¦çµæœå’Œå ±å‘Š

### 2. ç‰ˆæœ¬ç®¡ç†
- æ¯æ¬¡é‡è¦æ›´æ–°å¾Œå¢åŠ ç‰ˆæœ¬è™Ÿç¢¼
- è¨˜éŒ„è©³ç´°çš„ç‰ˆæœ¬æè¿°å’Œè®Šæ›´å…§å®¹
- å®šæœŸå‚™ä»½ç‰ˆæœ¬è³‡è¨Šæª”æ¡ˆ

### 3. æ•¸æ“šç®¡ç†
- å®šæœŸæ¸…ç†èˆŠçš„æ¸¬è©¦æ•¸æ“š
- å‚™ä»½é‡è¦çš„æ¸¬è©¦å ±å‘Š
- ä½¿ç”¨æœ‰æ„ç¾©çš„æª”æ¡ˆå‘½åè¦å‰‡

### 4. æ•ˆèƒ½å„ªåŒ–
- æ ¹æ“šéœ€è¦èª¿æ•´æ¡æ¨£åƒæ•¸
- é¿å…ä¸å¿…è¦çš„æ•¸æ“šé‡è¤‡è¨ˆç®—
- åˆç†è¨­ç½®æ¸¬è©¦æ™‚é–“å’Œé »ç‡

## ğŸ¤ æ”¯æ´å’Œè¯çµ¡

### æŠ€è¡“æ”¯æ´
- æª¢æŸ¥æ—¥èªŒæª”æ¡ˆç²å–è©³ç´°éŒ¯èª¤è³‡è¨Š
- åƒè€ƒç¨‹å¼ç¢¼è¨»è§£äº†è§£å¯¦ç¾ç´°ç¯€
- ä½¿ç”¨ç°¡å–®æ¸¬è©¦è…³æœ¬é©—è­‰åŠŸèƒ½

### å•é¡Œå›å ±
- è¨˜éŒ„éŒ¯èª¤ç™¼ç”Ÿçš„å…·é«”æƒ…æ³
- æä¾›ç›¸é—œçš„é…ç½®å’Œç’°å¢ƒè³‡è¨Š
- é™„ä¸ŠéŒ¯èª¤æ—¥èªŒå’Œå †ç–Šè¿½è¹¤

### åŠŸèƒ½å»ºè­°
- æè¿°æœŸæœ›çš„åŠŸèƒ½å’Œæ”¹é€²
- æä¾›å…·é«”çš„ä½¿ç”¨å ´æ™¯
- èªªæ˜å°å·¥ä½œæµç¨‹çš„å½±éŸ¿

---

**æ³¨æ„**: æœ¬è…³æœ¬å°ˆç‚ºæ¸¬è©¦ç’°å¢ƒè¨­è¨ˆï¼Œè«‹æ ¹æ“šå¯¦éš›éœ€æ±‚é€²è¡Œèª¿æ•´å’Œæ“´å±•ã€‚
**ç‰ˆæœ¬**: 1.0.0
**æ›´æ–°æ—¥æœŸ**: 2024-12-19
**ä½œè€…**: AI Assistant 