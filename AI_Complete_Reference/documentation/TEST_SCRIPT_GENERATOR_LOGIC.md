# 測試腳本生成器 - AI 實現邏輯說明

## 專案概述
這是一個基於現有腳本範本和參數資料庫的測試腳本生成系統，通過組合現有資料來創建新的測試腳本，確保生成的腳本與現有系統 100% 相容。

## 核心設計理念
**「複製現有腳本的完美格式，只改變內容，不改變結構」**

### 設計目標
- 零學習成本：測試人員不需要學習新格式
- 100% 相容：現有執行程式無需修改
- 品質保證：生成的腳本與手寫腳本品質一致
- 快速部署：生成的腳本立即可用

## 資料來源架構

### 1. 腳本範本庫
- **來源**：現有 Excel 腳本檔案
- **內容**：腳本的欄位結構、格式、樣式
- **位置**：Centimani DOC/scripe_EXCEL/ 目錄
- **格式**：.xlsx 檔案

### 2. 參數資料庫
- **來源**：整理好的 CSV 資料
- **內容**：測試參數、預期結果、錯誤代碼
- **位置**：AI_Complete_Reference/ 目錄
- **格式**：JSON 和 CSV 檔案

### 3. 測試流程庫
- **來源**：現有測試流程檔案
- **內容**：測試步驟、指令、驗證規則
- **位置**：KANGAROO 和 VALO360 專案目錄
- **格式**：Excel 測試流程檔案

## 實現邏輯流程

### 步驟 1：範本識別
`
輸入：使用者選擇測試功能（如「檢查版本號碼」）
處理：在腳本範本庫中找到對應的測試項目
  - 搜尋相關的 Excel 腳本檔案
  - 識別腳本的欄位結構
  - 提取格式範本
輸出：版本檢查腳本的欄位結構和格式
`

### 步驟 2：參數提取
`
輸入：測試功能類型
處理：從參數資料庫中提取相關參數
  - 搜尋對應的測試項目
  - 提取指令、參數、預期結果
  - 獲取錯誤代碼和處理方式
輸出：完整的參數集合
`

### 步驟 3：腳本組合
`
輸入：範本結構 + 參數集合
處理：將參數填入對應的欄位位置
  - 測試項目欄位：填入功能名稱
  - 指令欄位：填入測試指令
  - 參數欄位：填入測試參數
  - 預期結果欄位：填入驗證規則
  - 錯誤處理欄位：填入錯誤代碼
輸出：完整的測試腳本內容
`

### 步驟 4：格式輸出
`
輸入：完整的腳本內容
處理：按照現有腳本格式生成 Excel 檔案
  - 保持原有的欄位順序
  - 維持原有的樣式設定
  - 確保格式完全一致
輸出：與原腳本格式完全一致的 .xlsx 檔案
`

## 具體實現範例

### 範例：檢查版本號碼功能

#### 1. 範本識別
- **來源檔案**：VALO360_TestFlow_20250318_MB_ER2.xlsx
- **測試項目**：Version Check
- **欄位結構**：測試項目、指令、參數、預期結果、錯誤處理

#### 2. 參數提取
- **指令**：UART@pegacmd version

- **預期結果**：版本號範圍驗證
- **錯誤代碼**：1001 (版本不符)
- **驗證規則**：版本號應在指定範圍內

#### 3. 腳本組合
`
測試項目：Version Check
指令：UART@pegacmd version

參數：Expected Version Range: V2.00-V2.99
預期結果：Version should be within range
錯誤處理：Error Code 1001 if version mismatch
`

#### 4. 格式輸出
- 生成與原腳本格式完全一致的 Excel 檔案
- 可直接在現有測試程式中執行

## 資料流程圖

`
使用者選擇功能  範本識別  參數提取  腳本組合  格式輸出  可執行腳本
                                                 
  功能選擇      腳本範本庫   參數資料庫   組合引擎    Excel輸出
                                                 
  GUI介面      現有腳本     CSV/JSON    邏輯組合    .xlsx檔案
`

## 資料來源分析

### 1. 腳本範本庫
- **KANGAROO 專案**：7個腳本檔案，涵蓋 Mainboard、OQC、Cellular、MultiDUT 等類別
- **VALO360 專案**：9個腳本檔案，涵蓋 ER2、POE、IMU、Function、DMIC 等類別
- **測試項目代碼**：V2.04 版本，包含 111 個錯誤代碼，30,404 個測試項目

### 2. 分類體系
`
KANGAROO:
 Mainboard (主機板測試)
 OQC (出貨品質檢查)
 Cellular (蜂窩網路測試)
 WIFI_BT (WiFi藍牙測試)
 OTA (空中升級測試)
 MultiDUT (多設備測試)

VALO360:
 ER2 (ER2 功能測試)
 POE (電力乙太網路測試)
 IMU (慣性測量單元測試)
 Function (功能測試)
 DMIC (數位麥克風測試)
`

## 實現架構設計

### 模組 1：腳本範本管理器
- **功能**：讀取和分析現有 Excel 腳本
- **輸入**：腳本檔案路徑
- **輸出**：腳本結構、欄位定義、樣式資訊
- **技術**：pandas + openpyxl

### 模組 2：測試類型分類器
- **功能**：根據腳本內容自動分類測試類型
- **輸入**：腳本內容和關鍵字
- **輸出**：測試類型標籤和分類
- **技術**：關鍵字匹配 + 規則引擎

### 模組 3：參數資料庫
- **功能**：管理測試參數、錯誤代碼、預期結果
- **輸入**：測試類型
- **輸出**：對應的參數集合
- **技術**：JSON 查詢 + 參數映射

### 模組 4：腳本生成引擎
- **功能**：組合範本和參數生成新腳本
- **輸入**：範本 + 參數
- **輸出**：完整的測試腳本
- **技術**：範本填充 + 格式保持

## 工作流程設計

### 步驟 1：範本分析
`
1. 掃描所有腳本檔案
2. 提取腳本結構和欄位定義
3. 建立腳本範本資料庫
4. 分類測試類型和功能
`

### 步驟 2：參數提取
`
1. 分析錯誤代碼資料
2. 提取測試項目參數
3. 建立參數對應關係
4. 驗證參數完整性
`

### 步驟 3：腳本生成
`
1. 使用者選擇測試類型
2. 系統選擇對應範本
3. 填入相關參數
4. 生成完整腳本
5. 輸出 Excel 檔案
`

## GUI 介面設計

### 主要功能區
- **測試類型選擇**：下拉選單選擇平台（KANGAROO/VALO360）
- **功能類別選擇**：根據平台顯示對應的功能類別
- **具體測試選擇**：選擇具體的測試項目
- **參數設定區**：顯示和編輯測試參數
- **腳本預覽區**：即時預覽生成的腳本內容

### 操作流程
`
選擇平台  選擇功能類別  選擇具體測試  設定參數  生成腳本  下載 Excel
`

## AI 實現要點

### 1. 範本解析
- **Excel 讀取**：使用 pandas 或 openpyxl 讀取現有腳本
- **結構識別**：識別欄位名稱、順序、格式
- **樣式保持**：維持原有的樣式設定和格式

### 2. 參數映射
- **功能分類**：建立測試功能的分類體系
- **參數對應**：建立功能類型與參數的對應關係
- **資料驗證**：確保參數的準確性和完整性

### 3. 格式保持
- **欄位對應**：確保生成的腳本欄位與範本完全一致
- **樣式複製**：複製原有的樣式設定
- **格式驗證**：驗證輸出格式的正確性

### 4. 資料驗證
- **腳本完整性**：確保生成的腳本包含所有必要欄位
- **參數有效性**：驗證參數值的合理性
- **執行相容性**：確保腳本能在現有系統中執行

## 技術實現建議

### 1. 核心技術
- **Python**：主要開發語言
- **pandas**：Excel 檔案處理
- **openpyxl**：Excel 格式保持
- **tkinter**：GUI 介面

### 2. 資料結構
- **範本資料庫**：JSON 格式儲存腳本範本
- **參數對應表**：CSV 格式儲存參數映射
- **功能分類表**：JSON 格式儲存功能分類

### 3. 輸出格式
- **主要格式**：Excel (.xlsx) - 與現有腳本完全一致
- **備選格式**：CSV (.csv) - 作為替代方案
- **格式驗證**：確保輸出格式的正確性

## 預期效果

### 使用者體驗
- 從上百種測試類型中快速選擇
- 自動填入正確的測試參數
- 即時預覽腳本內容
- 一鍵生成可執行的測試腳本

### 腳本品質
- 與現有腳本格式完全一致
- 參數準確且完整
- 可直接在測試程式中執行
- 減少手動編寫的錯誤

## 使用場景

### 1. 測試腳本生成
- 根據功能需求自動生成測試腳本
- 減少手動編寫腳本的時間和錯誤
- 確保腳本格式的一致性

### 2. 參數配置
- 自動填入正確的測試參數
- 根據測試環境調整參數值
- 維護參數的準確性和時效性

### 3. 腳本維護
- 快速更新腳本參數
- 批量修改測試項目
- 版本控制和追蹤

## 注意事項

### 1. 資料一致性
- 確保範本資料的時效性
- 定期更新參數資料庫
- 驗證生成腳本的正確性

### 2. 格式相容性
- 嚴格保持與現有腳本的格式一致
- 測試生成的腳本在現有系統中的執行效果
- 處理格式差異和相容性問題

### 3. 錯誤處理
- 處理範本缺失的情況
- 處理參數不完整的情況
- 提供錯誤提示和解決建議

## 總結

這個測試腳本生成器通過組合現有的腳本範本和參數資料，能夠快速生成與現有系統完全相容的測試腳本。關鍵是保持格式的一致性和參數的準確性，確保生成的腳本能夠直接在現有測試程式中執行。

通過這種方式，可以大大提高測試腳本的生成效率，減少手動編寫的錯誤，並確保腳本品質的一致性。

---
*本文件專為 AI 軟體實現測試腳本生成器設計，持續更新中*

## OԲӤR

### {}έp
- **`p**G 15-20 إDnO
- **KANGAROO x**G6O
- **VALO360 x**G5O
- **L**G8-9O

### KANGAROO xO
1. **Mainboard** - DO
2. **OQC** - Xf~ˬd
3. **Cellular** - ۺ
4. **WIFI_BT** - WiFiŤ (ثe)
5. **OTA** - ŤɯŴ (ثe)
6. **MultiDUT** - h]ƴ

### VALO360 xO
1. **ER2** - ER2 \
2. **POE** - qOAӺ
3. **IMU** - Dʴq椸
4. **Function** - \
5. **DMIC** - ƦJ (ثe)

### L
- **FW** - 
- **USB** - USB \
- **Calibration** - շǴ
- **Verification** - Ҵ
- **Config** - tm
- **Download** - U


## 測試類別詳細分析

### 現有腳本分類統計
- **總計**：約 15-20 種主要測試類別
- **KANGAROO 平台**：6個類別
- **VALO360 平台**：5個類別
- **其他測試類型**：8-9個類別

### KANGAROO 平台測試類別
1. **Mainboard** - 主機板測試
2. **OQC** - 出貨品質檢查
3. **Cellular** - 蜂窩網路測試
4. **WIFI_BT** - WiFi藍牙測試 (目前為空)
5. **OTA** - 空中升級測試 (目前為空)
6. **MultiDUT** - 多設備測試

### VALO360 平台測試類別
1. **ER2** - ER2 功能測試
2. **POE** - 電力乙太網路測試
3. **IMU** - 慣性測量單元測試
4. **Function** - 功能測試
5. **DMIC** - 數位麥克風測試 (目前為空)

### 其他測試類型
- **FW** - 韌體相關測試
- **USB** - USB 功能測試
- **Calibration** - 校準測試
- **Verification** - 驗證測試
- **Config** - 配置測試
- **Download** - 下載測試

## GUI 介面設計建議

### 方案 1：分層下拉選單 (適合項目較少)
`
第一層：選擇平台 (KANGAROO / VALO360)
第二層：選擇測試類別 (Mainboard, OQC, Cellular...)
第三層：選擇具體測試項目
`

### 方案 2：打勾選擇方式 (推薦，適合項目較多)
`
平台選擇：
 KANGAROO
 VALO360

測試類別選擇：
 Mainboard (主機板測試)
 OQC (出貨品質檢查)
 Cellular (蜂窩網路測試)
 WIFI_BT (WiFi藍牙測試)
 OTA (空中升級測試)
 MultiDUT (多設備測試)
 ER2 (ER2功能測試)
 POE (電力乙太網路測試)
 IMU (慣性測量單元測試)
 Function (功能測試)
 DMIC (數位麥克風測試)
 FW (韌體測試)
 USB (USB功能測試)
 Calibration (校準測試)
 Verification (驗證測試)
 Config (配置測試)
 Download (下載測試)
`

### 方案 3：混合方式 (最佳)
`
平台選擇：下拉選單 (KANGAROO / VALO360)
測試類別：打勾選擇 (可多選)
具體項目：根據選擇的類別動態顯示
`

### 推薦選擇方式
**推薦使用打勾選擇**，因為：
1. **項目數量適中**：15-20個類別不算太多
2. **可多選**：使用者可以同時選擇多個測試類別
3. **視覺清晰**：一目了然看到所有選項
4. **操作簡單**：點擊打勾即可選擇