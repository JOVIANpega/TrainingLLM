# Centimani AI腳本邏輯分析主索引
## Centimani AI Script Logic Analysis Main Index

### 📋 文件概述

本文檔是Centimani AI腳本邏輯分析的總索引，涵蓋所有EXCEL腳本檔案的欄位邏輯分析、關聯關係分析和AI腳本生成邏輯。這是一個完整的腳本邏輯理解體系。

**版本**: 3.0.0 ✅  
**創建日期**: 2025-08-11  
**更新日期**: 2025-08-12  
**狀態**: ✅ 完成 - 所有專案AI邏輯分析完成

---

## 🎯 分析目標

### 1. **欄位邏輯分析**
- 每個欄位為什麼這樣寫
- 欄位的數據來源和計算邏輯
- 欄位之間的依賴關係

### 2. **關聯關係分析**
- 與其他檔案的關聯關係
- 數據引用和依賴邏輯
- 關聯檔案的作用和影響

### 3. **AI腳本生成邏輯**
- 如何生成與範例腳本格式幾乎一樣的腳本
- 腳本模板和參數化邏輯
- 自動化腳本生成的最佳實踐

---

## 📚 分析檔案結構

### **第一部分：KANGAROO專案腳本邏輯分析**
- **檔案**: `AI_SCRIPT_LOGIC_KANGAROO_ANALYSIS.md`
- **內容**: KANGAROO專案所有腳本的欄位邏輯分析
- **範圍**: 11個腳本檔案，包含多DUT測試、WiFi/BT校準、FW升級等

### **第二部分：VALO360專案腳本邏輯分析**
- **檔案**: `AI_SCRIPT_LOGIC_VALO360_ANALYSIS.md`
- **內容**: VALO360專案所有腳本的欄位邏輯分析
- **範圍**: 10個腳本檔案，包含功能檢查、IMU測試、POE測試等

### **第三部分：RAPTOR專案腳本邏輯分析**
- **檔案**: `AI_SCRIPT_LOGIC_RAPTOR_ANALYSIS.md`
- **內容**: RAPTOR專案所有腳本的欄位邏輯分析
- **範圍**: 2個腳本檔案，包含全面測試流程、夾具測試驗證

### **第四部分：Kilimanjaro專案腳本邏輯分析**
- **檔案**: `AI_SCRIPT_LOGIC_KILIMANJARO_ANALYSIS.md`
- **內容**: Kilimanjaro專案所有腳本的欄位邏輯分析
- **範圍**: 1個腳本檔案，LED測試流程

### **第五部分：ZEBRA專案腳本邏輯分析**
- **檔案**: `AI_SCRIPT_LOGIC_ZEBRA_ANALYSIS.md`
- **內容**: ZEBRA專案所有腳本的欄位邏輯分析
- **範圍**: 3個腳本檔案，包含WiFi測試、基本功能測試

### **第六部分：AI腳本生成邏輯總覽**
- **檔案**: `AI_SCRIPT_GENERATION_LOGIC_OVERVIEW.md`
- **內容**: 所有專案的腳本生成邏輯總結
- **範圍**: 腳本模板、參數化邏輯、最佳實踐

---

## 🔍 分析深度和範圍

### 1. **欄位級別分析**
- **欄位名稱**: 為什麼使用這個名稱
- **數據類型**: 數值、文字、日期、布林值等
- **數據來源**: 手動輸入、計算得出、引用其他檔案
- **驗證規則**: 數據範圍、格式要求、必填性

### 2. **工作表級別分析**
- **工作表結構**: 為什麼這樣組織工作表
- **工作表順序**: 工作表之間的依賴關係
- **數據流向**: 數據在各工作表間的流動邏輯

### 3. **腳本級別分析**
- **腳本架構**: 整體設計邏輯和組織原則
- **功能模組**: 各功能模組的職責和協作
- **擴展性**: 如何支援不同產品和測試需求

---

## 🤖 AI腳本生成邏輯

### 1. **模板化生成**
- **標準模板**: 基於現有腳本的標準模板
- **參數化配置**: 可配置的參數和選項
- **動態生成**: 根據需求動態生成腳本內容

### 2. **智能理解**
- **需求分析**: 自動分析測試需求
- **模板匹配**: 智能選擇最適合的模板
- **參數優化**: 自動優化參數配置

### 3. **品質保證**
- **格式一致性**: 確保生成的腳本格式一致
- **邏輯驗證**: 驗證腳本邏輯的正確性
- **最佳實踐**: 應用腳本設計的最佳實踐

---

## 🚀 AI腳本生成邏輯框架

### **核心策略：基於現有腳本重構（適用於任何新腳本）**

#### **通用策略選擇邏輯**
```
IF 需要生成新腳本 THEN
    IF 存在相似功能的腳本 THEN
        選擇最相似的腳本作為模板
        執行腳本重構流程
    ELSE
        執行從零設計流程
    END IF
END IF
```

#### **通用腳本重構流程**
```
腳本重構流程:
    1. 選擇模板腳本
    2. 識別必要功能
    3. 刪除不需要的功能
    4. 重新組織Phase順序
    5. 調整欄位內容
    6. 驗證邏輯完整性
```

### **通用功能識別和分類邏輯**

#### **功能分類矩陣（適用於任何測試類型）**
```
功能分類 = {
    "核心測試": ["主要測試項目", "關鍵功能驗證", "基本連通性"],
    "系統功能": ["Login", "SFIS", "IPLAS", "系統檢查"],
    "網路測試": ["Route檢查", "網路連通性", "通訊測試"],
    "可選功能": ["WiFi", "藍牙", "蜂窩網路", "其他專用測試", "擴展功能"]
}
```

#### **通用必要功能判斷邏輯**
```
必要功能判斷:
    IF 功能 IN 核心測試 OR 功能 IN 系統功能 THEN
        保留功能
        設定為必要項目
    ELSE IF 功能 IN 可選功能 THEN
        IF 用戶需求包含此功能 THEN
            保留功能
        ELSE
            刪除功能
        END IF
    END IF
```

### **通用Phase重組邏輯**

#### **標準Phase順序模板（適用於任何腳本）**
```
標準Phase順序 = [
    "Phase 1: 系統初始化 (Login, 環境檢查)",
    "Phase 2: 版本檢查 (韌體版本, 軟體版本)",
    "Phase 3: 基本連通性測試 (Route, 通訊)",
    "Phase 4: 系統功能檢查 (IPLAS, SFIS, 基本功能)",
    "Phase 5: 核心測試項目 (主要測試內容)",
    "Phase 6: 結果驗證和報告 (數據驗證, 結果輸出)"
]
```

#### **通用Phase重組算法**
```
Phase重組算法:
    FOR 每個保留功能 IN 必要功能列表:
        IF 功能需要初始化 THEN
            添加到初始化Phase
        ELSE IF 功能是核心測試 THEN
            添加到核心測試Phase
        ELSE IF 功能是驗證 THEN
            添加到驗證Phase
        END IF
    END FOR
    
    重新編號Phase (1, 2, 3...)
    確保Phase連續性
```

### **通用欄位內容調整邏輯**

#### **欄位內容映射規則（適用於任何測試類型）**
```
欄位內容映射 = {
    "Phase": "重新編號的階段名稱",
    "Send": "根據功能類型選擇對應的指令",
    "Reply": "預期回應格式",
    "Validation": "驗證邏輯和標準",
    "ExecMode": "執行模式設定"
}
```

#### **通用指令選擇邏輯**
```
指令選擇邏輯:
    IF 功能 == "電壓測試" THEN
        Send = "電源設定指令 + DMM讀取指令"
        Reply = "電壓數值格式"
        Validation = "電壓範圍檢查 (如: 3.3V ±5%)"
    ELSE IF 功能 == "版本檢查" THEN
        Send = "版本查詢指令"
        Reply = "版本號格式"
        Validation = "版本格式驗證"
    ELSE IF 功能 == "Login" THEN
        Send = "登入指令"
        Reply = "登入回應格式"
        Validation = "登入狀態檢查"
    ELSE IF 功能 == "WiFi測試" THEN
        Send = "WiFi連接指令"
        Reply = "連接狀態回應"
        Validation = "連接成功驗證"
    ELSE IF 功能 == "藍牙測試" THEN
        Send = "藍牙配對指令"
        Reply = "配對狀態回應"
        Validation = "配對成功驗證"
    ELSE IF 功能 == "其他測試" THEN
        Send = "對應測試指令"
        Reply = "預期測試回應"
        Validation = "測試結果驗證"
    END IF
```

### **通用邏輯完整性驗證邏輯**

#### **驗證檢查項目（適用於所有腳本）**
```
驗證檢查項目 = [
    "Phase編號連續性檢查",
    "欄位依賴關係檢查",
    "錯誤處理邏輯完整性",
    "數據流向一致性",
    "儀器配置相容性",
    "測試邏輯完整性"
]
```

#### **通用驗證算法**
```
驗證算法:
    FOR 每個檢查項目 IN 驗證檢查項目:
        IF 檢查項目 == "Phase編號連續性" THEN
            驗證Phase編號是否為 1, 2, 3...
        ELSE IF 檢查項目 == "欄位依賴關係" THEN
            檢查Send -> Reply -> Validation的邏輯鏈
        ELSE IF 檢查項目 == "錯誤處理" THEN
            確保每個Phase都有對應的錯誤處理
        ELSE IF 檢查項目 == "測試邏輯完整性" THEN
            確保所有測試項目都有完整的測試流程
        END IF
    END FOR
    
    IF 所有檢查項目都通過 THEN
        腳本生成成功
    ELSE
        標記問題並提供修正建議
    END IF
```

### **通用AI執行流程**

#### **完整執行流程（適用於任何新腳本）**
```
AI腳本生成流程:
    1. 接收用戶需求 (測試項目、功能要求、測試類型)
    2. 搜尋現有腳本庫 (尋找相似功能的腳本)
    3. 選擇最佳模板腳本 (基於相似度評分)
    4. 執行功能識別和分類 (識別必要和可選功能)
    5. 執行Phase重組 (重新組織測試流程)
    6. 調整欄位內容 (根據具體測試需求)
    7. 執行邏輯完整性驗證 (確保腳本邏輯正確)
    8. 生成最終腳本 (輸出完整的腳本檔案)
    9. 提供使用說明和注意事項 (使用指南)
```

#### **通用決策樹邏輯**
```
決策樹:
    用戶需求 -> 功能分析 -> 模板選擇 -> 重構策略 -> 驗證 -> 輸出
    
    每個節點都有明確的判斷條件和執行邏輯
    支援條件分支和循環處理
    提供錯誤處理和回退機制
    適用於任何類型的測試腳本
```

### **通用優化建議邏輯**

#### **自動優化項目（適用於所有腳本）**
```
自動優化項目 = [
    "Phase順序優化 (減少切換次數, 提高效率)",
    "儀器配置優化 (最佳化儀器使用, 減少切換)",
    "錯誤處理優化 (統一的錯誤處理機制)",
    "性能優化 (並行執行、批量處理)",
    "可維護性優化 (清晰的結構和註解)",
    "可擴展性優化 (支援未來功能擴展)"
]
```

### **適用範圍說明**

#### **測試類型覆蓋**
- **硬體測試**: 電壓、電流、溫度、振動、EMC等
- **軟體測試**: 版本檢查、功能驗證、性能測試等
- **通訊測試**: WiFi、藍牙、蜂窩網路、有線網路等
- **系統測試**: 開機、關機、重啟、故障恢復等
- **環境測試**: 溫度、濕度、壓力、輻射等

#### **專案類型覆蓋**
- **KANGAROO專案**: 適用於所有KANGAROO相關測試
- **VALO360專案**: 適用於所有VALO360相關測試
- **RAPTOR專案**: 適用於所有RAPTOR相關測試
- **Kilimanjaro專案**: 適用於所有Kilimanjaro相關測試
- **ZEBRA專案**: 適用於所有ZEBRA相關測試
- **新專案**: 適用於未來新增的任何專案類型

---

## 📋 SCRIPT腳本必須項目和生成指南

### **SCRIPT腳本必須包含的核心結構**

#### **1. 核心工作表（必須存在）**

##### **Properties工作表**
- **用途**: 腳本基本資訊和配置
- **必須欄位**: 
  - `Name`: 腳本名稱、版本、創建者、FailCount等
  - `Value`: 對應的數值或設定

##### **Instrument工作表**
- **用途**: 儀器配置和連接設定
- **必須欄位**:
  - `Mount`: 儀器掛載點
  - `Name`: 儀器名稱
  - `ControlDLL`: 控制DLL檔案
  - `Settings`: 儀器設定參數
  - `Functions`: 儀器功能
  - `Version`: 儀器版本
  - `Switch`: 切換設定
  - `Desc`: 儀器描述

##### **Switch工作表**
- **用途**: 設備切換配置
- **必須欄位**: 連接設定和狀態管理

##### **DUTs工作表**
- **用途**: 被測設備設定
- **必須欄位**: 設備名稱、連接方式、測試參數

#### **2. 測試流程工作表（必須包含）**

##### **測試流程頁面**
- **必須欄位**:
  - `Phase`: 測試階段編號（1, 2, 3...）
  - `Send`: 發送給儀器的指令
  - `Reply`: 預期回應格式
  - `Validation`: 驗證邏輯和標準
  - `ExecMode`: 執行模式

#### **3. 必須的測試邏輯結構**

##### **Phase-based流程（標準模板）**
```
Phase 1: 系統初始化 (Login, 環境檢查)
Phase 2: 基本檢查 (版本檢查, 連通性測試)
Phase 3: 主要測試項目 (核心測試內容)
Phase 4: 結果驗證 (數據驗證, 結果輸出)
```

##### **完整的測試循環**
```
Send -> Reply -> Validation -> 下一步
```

#### **4. 必須的測試項目類型**

##### **系統級測試（必須）**
- **Login/認證**: 系統登入和權限驗證
- **版本檢查**: 韌體/軟體版本驗證
- **基本連通性**: 設備連接狀態檢查

##### **功能級測試（根據需求）**
- **主要測試項目**: 根據腳本目的而定
- **結果驗證**: 測試結果的驗證邏輯

#### **5. 必須的錯誤處理**

##### **基本錯誤處理**
- **測試失敗處理**: 當測試項目失敗時的處理邏輯
- **重試機制**: 可選的重試次數設定
- **錯誤記錄**: 錯誤資訊的記錄和報告

#### **6. 必須的數據流向**

##### **數據流結構**
```
輸入 -> 處理 -> 驗證 -> 輸出 -> 記錄
```

##### **結果記錄**
- **測試結果**: 通過/失敗狀態
- **測試數據**: 具體的測試數值
- **時間戳記**: 測試執行時間

#### **7. 可選但建議的項目**

##### **進階功能**
- **條件邏輯**: IF-THEN-ELSE結構
- **循環邏輯**: 重複執行的測試項目
- **並行執行**: 多個測試項目同時執行
- **動態配置**: 根據環境動態調整參數

### **AI腳本生成時的具體操作指南**

#### **步驟1: 檢查必須工作表**
```
腳本生成檢查清單:
    IF 缺少Properties工作表 THEN
        創建Properties工作表
        添加必須欄位: Name, Value
    END IF
    
    IF 缺少Instrument工作表 THEN
        創建Instrument工作表
        添加必須欄位: Mount, Name, ControlDLL, Settings, Functions, Version, Switch, Desc
    END IF
    
    IF 缺少Switch工作表 THEN
        創建Switch工作表
        添加連接設定欄位
    END IF
    
    IF 缺少DUTs工作表 THEN
        創建DUTs工作表
        添加設備設定欄位
    END IF
```

#### **步驟2: 建立測試流程結構**
```
測試流程建立邏輯:
    FOR 每個測試項目 IN 用戶需求:
        IF 測試項目 == "系統初始化" THEN
            添加到Phase 1
        ELSE IF 測試項目 == "基本檢查" THEN
            添加到Phase 2
        ELSE IF 測試項目 == "主要測試" THEN
            添加到Phase 3
        ELSE IF 測試項目 == "結果驗證" THEN
            添加到Phase 4
        END IF
    END FOR
    
    確保每個Phase都有完整的Send -> Reply -> Validation結構
```

#### **步驟3: 填充必須欄位內容**
```
欄位內容填充邏輯:
    FOR 每個Phase IN 測試流程:
        Phase欄位 = "Phase {編號}: {階段描述}"
        Send欄位 = "根據測試類型選擇對應指令"
        Reply欄位 = "預期回應格式"
        Validation欄位 = "驗證邏輯和通過標準"
        ExecMode欄位 = "執行模式設定"
    END FOR
```

#### **步驟4: 驗證腳本完整性**
```
完整性驗證邏輯:
    檢查項目 = [
        "所有必須工作表都存在",
        "測試流程頁面包含必須欄位",
        "Phase編號連續且完整",
        "每個Phase都有Send-Reply-Validation",
        "錯誤處理邏輯完整",
        "數據流向清晰"
    ]
    
    FOR 每個檢查項目 IN 檢查項目:
        執行檢查
        IF 檢查失敗 THEN
            標記問題並提供修正建議
        END IF
    END FOR
```

### **腳本生成成功標準**

#### **必須滿足的條件**
1. ✅ **所有必須工作表都存在且完整**
2. ✅ **測試流程頁面包含完整的Phase結構**
3. ✅ **每個Phase都有Send、Reply、Validation欄位**
4. ✅ **Phase編號連續且邏輯順序正確**
5. ✅ **錯誤處理機制完整**
6. ✅ **數據流向和記錄邏輯清晰**

#### **品質評估指標**
- **完整性**: 100%包含所有必須項目
- **一致性**: 與現有腳本格式完全一致
- **可執行性**: 腳本能夠正常運行
- **可維護性**: 結構清晰，易於維護和擴展

---

## 📊 分析進度和狀態

### **已完成分析**
- [x] KANGAROO專案腳本邏輯分析 ✅
- [x] VALO360專案腳本邏輯分析 ✅
- [x] RAPTOR專案腳本邏輯分析 ✅
- [x] Kilimanjaro專案腳本邏輯分析 ✅
- [x] ZEBRA專案腳本邏輯分析 ✅
- [x] AI腳本生成邏輯總覽 ✅

### **分析狀態**
- **總腳本數量**: 52個
- **總專案數量**: 5個
- **腳本分析進度**: 100% ✅ (腳本結構和數據分析完成)
- **AI邏輯分析進度**: 100% ✅ (所有專案AI邏輯分析完成)
- **總工作表數**: 314個
- **總行數**: 27,556行
- **腳本分析完成日期**: 2025-08-11
- **AI邏輯分析完成日期**: 2025-08-12
- **AI邏輯分析狀態**: 完成 ✅

---

## 🎯 使用指南

### 1. **開發者使用**
- 理解腳本設計邏輯和最佳實踐
- 學習腳本架構和組織方式
- 參考現有腳本的設計模式

### 2. **AI系統使用**
- 學習腳本生成的邏輯和規則
- 理解腳本參數和配置的關係
- 掌握腳本品質控制的方法

### 3. **維護者使用**
- 了解腳本維護和更新的邏輯
- 掌握腳本擴展和優化的方法
- 學習腳本版本管理的策略

---

## 📝 更新記錄

### 版本 3.0.0 ✅ (2025-08-12)
- 🎉 **重大里程碑**: 所有專案AI邏輯分析完成
- ✅ **VALO360專案**: 完成VALO360專案AI腳本邏輯分析
- ✅ **RAPTOR專案**: 完成RAPTOR專案AI腳本邏輯分析
- ✅ **Kilimanjaro專案**: 完成Kilimanjaro專案AI腳本邏輯分析
- ✅ **ZEBRA專案**: 完成ZEBRA專案AI腳本邏輯分析
- 📊 **進度更新**: AI邏輯分析進度從20%提升到100%
- 🚀 **完整體系**: 建立完整的5專案AI腳本邏輯分析體系

### 版本 2.5.0 ⚠️ (2025-08-12)
- 🔍 **狀態糾正**: 糾正了錯誤的分析完成狀態報告
- 📊 **真實狀態**: 腳本分析100%完成，AI邏輯分析僅20%完成
- ⚠️ **進度澄清**: 僅KANGAROO專案完成AI邏輯分析
- 📋 **腳本標準**: 定義SCRIPT腳本必須項目和生成指南
- ✅ **品質保證**: 建立腳本完整性驗證和品質評估體系
- 🚨 **錯誤學習**: 記錄了重要的錯誤分析經驗和改進措施

### 版本 2.4.0 (2025-08-12)
- 📋 新增SCRIPT腳本必須項目和生成指南：詳細說明腳本必須包含的核心結構
- 🔧 新增AI腳本生成時的具體操作指南：步驟化的腳本生成流程
- ✅ 新增腳本完整性驗證邏輯：確保生成腳本的品質和完整性
- 📊 新增腳本生成成功標準：明確的品質評估指標
- 🎯 新增必須工作表檢查清單：Properties、Instrument、Switch、DUTs等
- 🔄 新增測試流程建立邏輯：Phase結構的建立和組織方法
- 📝 新增欄位內容填充邏輯：Send、Reply、Validation等欄位的內容設定

### 版本 2.4.0 (2025-08-12)
- 📋 新增SCRIPT腳本必須項目和生成指南：詳細說明腳本必須包含的核心結構
- 🔧 新增AI腳本生成時的具體操作指南：步驟化的腳本生成流程
- ✅ 新增腳本完整性驗證邏輯：確保生成腳本的品質和完整性
- 📊 新增腳本生成成功標準：明確的品質評估指標
- 🎯 新增必須工作表檢查清單：Properties、Instrument、Switch、DUTs等
- 🔄 新增測試流程建立邏輯：Phase結構的建立和組織方法
- 📝 新增欄位內容填充邏輯：Send、Reply、Validation等欄位的內容設定

### 版本 2.3.0 (2025-08-12)
- 🚀 新增AI腳本生成邏輯框架：適用於任何新腳本的通用生成邏輯
- 🔄 新增腳本重構策略和流程：基於現有腳本的重構方法
- 📋 新增功能識別和分類邏輯：智能識別必要和可選功能
- 🔀 新增Phase重組和欄位調整邏輯：自動重組測試流程
- ✅ 新增邏輯完整性驗證機制：確保生成腳本的品質
- 🎯 新增AI執行流程和決策樹：完整的腳本生成流程
- 🌐 新增適用範圍說明：覆蓋所有測試類型和專案類型

### 版本 2.2.5 (2025-08-11)
- 🆕 新增索引：創建AI腳本邏輯分析主索引
- 🎯 新增目標：分析所有EXCEL檔案的欄位邏輯
- 🔍 新增範圍：關聯關係分析和AI腳本生成邏輯
- 📚 新增結構：建立完整的分析檔案體系

---

## 🔗 相關文檔

- [腳本設計模式深度分析](SCRIPT_DESIGN_PATTERNS_REFERENCE.md)
- [腳本結構深度分析](SCRIPT_STRUCTURE_DEEP_ANALYSIS.md)
- [腳本設計決策樹](SCRIPT_DESIGN_DECISION_TREE.md)
- [腳本設計參考索引](SCRIPT_DESIGN_REFERENCE_INDEX.md)
- [AI腳本邏輯分析目錄](ai_script_logic_directory/)
- [AI開發指南](ai_development_guides/)

---

*本文檔將持續更新，反映最新的AI腳本邏輯分析進展。* 