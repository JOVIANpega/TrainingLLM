# 智能測試腳本生成器 - AI 邏輯參考

## 專案概述

智能測試腳本生成器是一個結合預設選項和智能理解的 GUI 工具，讓使用者可以快速生成各種測試腳本，無需深入了解腳本結構和參數配置。

## 核心功能架構

### 1. 雙重輸入機制
- **下拉選項系統**：提供常見測試項目的快速選擇
- **自定義指令輸入**：支援自然語言描述特殊測試需求
- **混合模式**：結合預設選項和自定義需求

### 2. 智能腳本生成
- **模板匹配引擎**：根據選擇自動選擇最適合的腳本模板
- **參數自動填充**：自動填入設備相關參數（IP、COM埠等）
- **內容智能調整**：根據自定義指令調整腳本內容

## 測試項目分類

### 版本檢查類
- 檢查版本
- 版本驗證
- 韌體版本檢查
- 軟體版本確認

### 量測類
- 量測電壓
- 量測電流
- 量測功率
- 量測溫度
- 量測頻率
- 量測阻抗

### 功能檢查類
- 檢查 BT（藍牙）
- 檢查 WiFi
- 檢查 IMU
- 檢查 GPS
- 檢查蜂鳴器
- 檢查 LED
- 檢查按鍵

### 通訊測試類
- 檢查網路連線
- 檢查 USB 通訊
- 檢查序列埠通訊
- 檢查 I2C 通訊
- 檢查 SPI 通訊

### 效能測試類
- 效能測試
- 壓力測試
- 穩定性測試
- 迴圈測試

## 工作流程邏輯

### 第一階段：選擇與輸入
```
1. 從下拉選單選擇主要測試類型
2. 可選：輸入自定義測試需求
3. 系統自動識別測試意圖
```

### 第二階段：模板匹配
```
1. 根據選擇的測試類型搜尋合適模板
2. 檢查設備相容性
3. 選擇最佳匹配的腳本模板
```

### 第三階段：參數配置
```
1. 自動填入基本參數（IP、COM埠、設備型號）
2. 根據測試類型調整特定參數
3. 驗證參數的有效性
```

### 第四階段：腳本生成
```
1. 組合選定的模板和自定義需求
2. 生成完整的測試腳本
3. 輸出 XLSX 格式檔案
```

## 智能理解機制

### 關鍵字識別
- **測試類型**：檢查、量測、測試、驗證
- **測試項目**：WiFi、藍牙、IMU、GPS、電壓、電流
- **測試條件**：頻段、負載、溫度、壓力
- **設備型號**：VALO360、KANGAROO、RAPTOR

### 意圖理解
- **功能測試**：檢查設備各項功能是否正常
- **效能測試**：測試設備在各種條件下的表現
- **穩定性測試**：長時間運行測試
- **相容性測試**：不同環境下的適應性

## 腳本設計邏輯與結構

### 腳本結構設計原理

#### 為什麼要分步驟編號？
**測試流程控制：**
- 每個測試步驟都有唯一編號（如 066-093），便於追蹤和除錯
- 當測試失敗時，可以精確定位到哪個步驟出問題
- 支援跳轉和條件執行（如某些步驟失敗後跳過後續測試）

**測試報告生成：**
- 步驟編號對應測試結果，便於生成詳細報告
- 可以統計每個步驟的成功/失敗率
- 便於品質分析和改進

#### 為什麼要分測試區塊？
**邏輯分組：**
- `Measure Voltage 1,4`：電壓測試區塊
- `Measure Voltage Forward,2`：正向電壓測試
- `Measure Voltage Reverse,2`：反向電壓測試
- `Check Gyro`：陀螺儀檢查
- `Check E compass`：電子羅盤檢查

**測試策略：**
- 相關的測試項目放在一起，邏輯清晰
- 可以設定區塊級別的通過/失敗條件
- 便於測試工程師理解和維護

#### 為什麼要用標準化命令？
**設備控制標準化：**
- `:ObtainDevice`：獲取設備控制權
- `:ReleaseDevice`：釋放設備控制權
- `:Delay, "1500"`：延遲 1500ms
- `:CheckLimit`：檢查測量值是否在限值範圍內

**好處：**
- 不同工程師寫的腳本都能被系統理解
- 便於自動化執行和結果分析
- 減少人為錯誤和腳本語法問題

#### 為什麼要參數化測試點？
**測試點管理：**
- `P1V1_TP2500`：電源 1.1V 測試點
- `VIO_TP801`：VIO 電壓測試點
- `ICR-P_TP2302`：紅外截止濾波器測試點

**參數化優勢：**
- 測試點名稱有明確含義，便於理解
- 可以批量修改測試參數
- 支援不同設備型號的測試點映射

#### 為什麼要用 UART 診斷命令？
**設備通訊標準化：**
- `UART@diag -s ircut on s 4`：開啟紅外截止濾波器
- `UART@diag -g who imu`：查詢 IMU 設備資訊
- `UART@diag -g who mag`：查詢磁力計設備資訊

**設計原因：**
- UART 是標準的串列通訊介面，相容性好
- 診斷命令格式統一，便於解析和處理
- 支援設備狀態查詢和參數設定

#### 為什麼要設定限值檢查？
**品質控制：**
- `:CheckLimit, "*(VIO_TP801)","3.61","3.99","%f"`
- 檢查 VIO_TP801 測試點的電壓值是否在 3.61V-3.99V 範圍內

**限值管理：**
- 自動判斷測試是否通過
- 支援不同測試點的個別限值設定
- 便於品質標準的統一管理

#### 為什麼要加入描述欄位？
**可讀性提升：**
- `PC#-#Wait time@#$`：PC 等待時間
- `INST##Get Voltage`：儀器獲取電壓
- `DUT#-#Check Gyro`：被測設備檢查陀螺儀

**維護便利性：**
- 新工程師能快速理解腳本功能
- 便於腳本除錯和修改
- 支援多語言描述

#### 為什麼要用代碼識別？
**錯誤追蹤：**
- `B7PL025`、`BRME027`、`WUPO010` 等代碼
- 每個測試步驟都有唯一識別碼
- 便於錯誤報告和問題追蹤

**系統整合：**
- 與測試管理系統的整合
- 支援自動化測試報告生成
- 便於品質分析和改進

### 腳本設計核心思想

**「標準化 + 可追蹤 + 易維護」：**

1. **標準化**：統一的命令格式和參數結構
2. **可追蹤**：每個步驟都有編號和識別碼
3. **易維護**：清晰的邏輯分組和描述說明
4. **自動化**：支援自動執行和結果判斷
5. **品質控制**：內建限值檢查和錯誤處理

這樣的設計讓測試腳本既能被機器自動執行，又能被人類工程師輕鬆理解和維護，是工業級測試自動化的典型做法。

## 腳本模板管理

### 模板結構
- **基本資訊**：測試名稱、設備型號、版本
- **測試項目**：具體的測試步驟和參數
- **參數配置**：IP位址、COM埠、測試條件
- **結果處理**：測試結果的記錄和分析

### 模板分類
- **按設備分類**：VALO360、KANGAROO、RAPTOR、ZEBRA
- **按功能分類**：通訊測試、量測測試、功能測試
- **按複雜度分類**：簡單測試、綜合測試、複雜測試

## 使用者體驗設計

### 介面佈局
- **頂部**：標題和基本說明
- **左側**：測試類型選擇區（下拉選單）
- **中央**：自定義需求輸入區
- **右側**：參數預覽和配置區
- **底部**：生成按鈕和結果顯示區

### 操作流程
1. **選擇測試類型**：從下拉選單選擇
2. **輸入特殊需求**：描述額外的測試要求
3. **預覽配置**：檢查自動填入的參數
4. **生成腳本**：點擊生成按鈕
5. **下載使用**：取得生成的測試腳本

## 進階功能

### 腳本優化
- **自動參數調整**：根據測試需求優化參數
- **測試項目組合**：智能組合相關測試項目
- **錯誤預防**：檢查參數衝突和相容性問題

### 模板學習
- **使用頻率統計**：記錄常用測試類型
- **使用者偏好**：學習個人的測試習慣
- **模板推薦**：根據歷史使用推薦最佳模板

### 協作功能
- **模板分享**：支援團隊間模板共享
- **版本控制**：管理腳本模板的版本更新
- **使用統計**：分析腳本使用情況

## 技術實現要點

### 核心技術
- **GUI 框架**：使用 Tkinter 開發
- **自然語言處理**：關鍵字識別和意圖理解
- **模板引擎**：腳本模板的動態生成
- **參數管理**：自動參數填充和驗證

### 資料管理
- **模板資料庫**：結構化儲存腳本模板
- **參數配置**：設備參數的集中管理
- **使用記錄**：記錄腳本生成和使用情況

### 錯誤處理
- **參數驗證**：檢查輸入參數的有效性
- **相容性檢查**：確保腳本與設備相容
- **異常處理**：優雅處理各種錯誤情況

## 應用場景範例

### 標準測試場景
- **需求**：檢查 VALO360 的 WiFi 功能
- **操作**：選擇「檢查 WiFi」→ 點擊生成
- **結果**：自動生成 WiFi 功能測試腳本

### 自定義測試場景
- **需求**：測試 WiFi 在不同頻段和負載下的效能
- **操作**：選擇「檢查 WiFi」+ 輸入「需要測試 2.4G/5G 頻段和負載測試」
- **結果**：生成包含多頻段和負載測試的 WiFi 效能測試腳本

### 綜合測試場景
- **需求**：VALO360 的完整功能測試
- **操作**：選擇「功能測試」+ 輸入「包含 WiFi、藍牙、IMU、GPS 等所有功能」
- **結果**：生成綜合功能測試腳本

## 版本資訊

- **版本**：v1.1.0
- **建立日期**：2025年1月
- **更新日期**：2025年1月
- **狀態**：AI 邏輯參考完成，腳本設計邏輯分析完成，待實作
- **更新內容**：
  - 新增腳本設計邏輯與結構分析
  - 詳細說明測試腳本各項設計原理
  - 解釋為什麼要使用特定的腳本結構
  - 提供腳本設計的核心思想指導

## 聯絡資訊

如有問題或建議，請參考相關說明文件或聯絡開發團隊。

---

_本文件為智能測試腳本生成器的 AI 邏輯參考，為後續程式開發提供指導方向_ 